<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€Šåäººå°ç»„ - æœªæ¥è¿œå¾æ¨¡æ‹Ÿã€‹V0.8 </title>
    <style>
        :root {
            --primary-text-color: #333;
            --secondary-text-color: #555;
            --bg-color: #f4f7f6;
            --container-bg-color: #fff;
            --card-bg-color: #f9f9f9;
            --card-border-color: #e0e0e0;
            --event-section-bg-color: #e9edf0;
            --button-bg-color: #2980b9;
            --button-text-color: white;
            --button-hover-bg-color: #2c3e50;
            --disabled-button-bg-color: #f0f0f0;
            --disabled-button-text-color: #aaa;
            --log-bg-color: #f9f9f9;
            --log-border-color: #e0e0e0;
            --header-border-color: #e0e0e0;
            --tooltip-bg-color: #555;
            --tooltip-text-color: #fff;
            --progress-bar-bg: #e0e0e0;
            --default-progress-value-color: #3498db; /* Will be overridden by JS */
            --theme-toggle-bg: #34495e;
            --theme-toggle-text: #ecf0f1;
            --radar-line-color: #ccc;
            --radar-data-fill: rgba(52, 152, 219, 0.2);
            --radar-data-stroke: #3498db;
            --radar-point-color: #2980b9;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 10px;
            background-color: var(--bg-color);
            color: var(--primary-text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: background-color 0.3s, color 0.3s;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            width: 95%;
            max-width: 1200px;
            background-color: var(--container-bg-color);
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 15px;
            transition: background-color 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
        }

        body.dark-mode {
            --primary-text-color: #ecf0f1;
            --secondary-text-color: #bdc3c7;
            --bg-color: #2c3e50;
            --container-bg-color: #34495e;
            --card-bg-color: #4a6179;
            --card-border-color: #5d7083;
            --event-section-bg-color: #4a6179;
            --button-bg-color: #3498db;
            --button-text-color: #ecf0f1;
            --button-hover-bg-color: #2980b9;
            --disabled-button-bg-color: #5d7083;
            --disabled-button-text-color: #7f8c8d;
            --log-bg-color: #4a6179;
            --log-border-color: #5d7083;
            --header-border-color: #4a6179;
            --tooltip-bg-color: #f0f0f0;
            --tooltip-text-color: #333;
            --progress-bar-bg: #5d7083;
            --theme-toggle-bg: #ecf0f1;
            --theme-toggle-text: #34495e;
        }
        
        header {
            text-align: center;
            margin-bottom: 8px;
            border-bottom: 1px solid var(--header-border-color);
            padding-bottom: 8px;
            flex: 0 0 auto;
        }

        h1 {
            color: var(--primary-text-color);
            font-size: 1.8em;
            margin: 0.1em 0;
        }

        #phaseDisplay {
            font-style: italic;
            color: var(--secondary-text-color);
            margin-bottom: 5px;
        }

        #statusDashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 15px;
            width: 100%;
        }

        .status-card {
            background-color: var(--card-bg-color);
            border: 1px solid var(--card-border-color);
            border-radius: 6px;
            padding: 6px;
            position: relative;
            transition: transform 0.2s ease-in-out, background-color 0.3s, border-color 0.3s;
            flex: 1 1 180px;
            max-width: 32%;
            min-width: 160px;
        }
        .status-card:hover {
            transform: translateY(-2px);
        }

        .status-card h3 {
            margin-top: 0;
            margin-bottom: 3px;
            font-size: 0.9em;
            color: var(--primary-text-color);
            display: flex;
            align-items: center;
        }
         .status-card h3 svg {
            margin-right: 8px;
            width: 20px;
            height: 20px;
            fill: var(--primary-text-color); 
        }

        .status-card .value {
            font-size: 1.4em;
            font-weight: bold;
            color: var(--primary-text-color);
            margin-bottom: 2px;
        }

        .status-card .description {
            font-size: 0.85em;
            color: var(--secondary-text-color);
            min-height: 2.5em; 
            margin-bottom: 5px;
        }

        .tooltip {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: help;
            color: var(--secondary-text-color);
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: var(--tooltip-bg-color);
            color: var(--tooltip-text-color);
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%; 
            left: 50%;
            margin-left: -110px; 
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        progress {
            width: 100%;
            height: 12px;
            border-radius: 6px;
            -webkit-appearance: none;
            appearance: none;
            background-color: var(--progress-bar-bg);
            border: 1px solid var(--card-border-color); 
        }

        progress::-webkit-progress-bar {
            background-color: var(--progress-bar-bg);
            border-radius: 6px;
        }

        progress::-webkit-progress-value {
            background-color: var(--default-progress-value-color); 
            border-radius: 6px;
            transition: background-color 0.5s ease, width 0.3s ease; 
        }

        progress::-moz-progress-bar { 
            background-color: var(--default-progress-value-color);
            border-radius: 6px;
            transition: background-color 0.5s ease, width 0.3s ease;
        }


        #eventSection {
            background-color: var(--event-section-bg-color);
            padding: 18px;
            border-radius: 6px;
            margin-bottom: 10px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        #eventTitle {
            font-size: 1.3em;
            color: #c0392b; 
            margin-bottom: 8px;
            flex: 0 0 auto;
            padding: 5px 0;
            border-bottom: 1px dashed var(--card-border-color);
        }
        body.dark-mode #eventTitle {
            color: #e67e22; 
        }


        #eventDescription {
            font-size: 0.95em;
            line-height: 1.5;
            margin-bottom: 15px;
            padding: 10px 0;
        }

        #choicesContainer {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
            padding-top: 10px;
            margin-bottom: 10px;
        }

        #choicesContainer button {
            display: block;
            width: calc(100% - 10px);
            padding: 10px;
            margin: 0 auto;
            background-color: var(--button-bg-color);
            color: var(--button-text-color);
            border: 1px solid transparent; 
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s;
        }
        body.dark-mode #choicesContainer button {
            border-color: #2980b9; 
        }


        #choicesContainer button:hover {
            background-color: var(--button-hover-bg-color);
        }

        #feedbackText {
            margin-top: 12px;
            font-style: italic;
            color: var(--secondary-text-color);
            padding: 10px;
            background-color: var(--card-bg-color); 
            border-radius: 4px;
            border-left: 3px solid var(--default-progress-value-color);
            font-size: 0.9em;
            flex: 0 0 auto;
        }

        .controls {
            text-align: center;
            margin-bottom: 10px;
            flex: 0 0 auto;
        }

        .controls button {
            padding: 8px 16px;
            font-size: 0.95em;
            margin: 0 8px;
            cursor: pointer;
            border-radius: 4px;
            border: 1px solid var(--card-border-color);
            background-color: var(--button-bg-color);
            color: var(--button-text-color);
            transition: background-color 0.2s;
        }
        .controls button:disabled {
            background-color: var(--disabled-button-bg-color);
            color: var(--disabled-button-text-color);
            cursor: not-allowed;
        }
        .controls button:not(:disabled):hover {
            background-color: var(--button-hover-bg-color);
        }

        #gameLogSection {
            margin-top: 10px;
        }

        #gameLogSection h2 {
            text-align: center;
            margin-bottom: 10px;
            color: var(--primary-text-color);
            font-size: 1.2em;
            padding-top: 5px;
        }

        #gameLogUl {
            list-style-type: none;
            padding: 0;
            max-height: 30vh;
            overflow-y: auto;
            border: 1px solid var(--log-border-color);
            border-radius: 4px;
            padding: 8px;
            background-color: var(--log-bg-color);
            margin-bottom: 10px;
        }

        .log-entry {
            padding: 6px;
            margin-bottom: 3px;
            border-left-width: 3px;
            border-left-style: solid;
            background-color: var(--container-bg-color); 
            font-size: 0.85em;
            border-radius: 0 3px 3px 0;
            word-wrap: break-word; 
        }
         body.dark-mode .log-entry {
            background-color: #5d7083;
         }

        .log-entry.system { border-left-color: #7f8c8d; } 
        .log-entry.year { border-left-color: #2ecc71; font-weight: bold;} 
        .log-entry.game-event { border-left-color: #9b59b6; font-style: italic; } 
        .log-entry.decision { border-left-color: #e67e22; } 
        .log-entry.game-over { 
            border-left-color: #c0392b; 
            font-weight: bold; 
            color: #c0392b;
        }
        body.dark-mode .log-entry.game-over {
            color: #e74c3c; 
            border-left-color: #e74c3c;
        }


        #gameOverMessage {
            text-align: center;
            font-size: 1.5em;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
            border-width: 1px;
            border-style: solid;
        }
        #gameOverMessage.victory {
            background-color: #d4efdf; color: #1e8449; border-color: #a9dfbf;
        }
        body.dark-mode #gameOverMessage.victory {
            background-color: #27ae60; color: #ecf0f1; border-color: #2ecc71;
        }
        #gameOverMessage.defeat { 
            background-color: #f9e79f; color: #b7950b; border-color: #f8c471;
        }
         body.dark-mode #gameOverMessage.defeat {
            background-color: #f39c12; color: #2c3e50; border-color: #e67e22;
        }
        #gameOverMessage.crisis { 
            background-color: #f5b7b1; color: #c0392b; border-color: #e6b0aa;
        }
        body.dark-mode #gameOverMessage.crisis {
            background-color: #e74c3c; color: #ecf0f1; border-color: #c0392b;
        }

        .theme-toggle-button {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 12px;
            background-color: var(--theme-toggle-bg);
            color: var(--theme-toggle-text);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            z-index: 100;
            font-size: 0.9em;
        }

        /* é›·è¾¾å›¾æ ·å¼ */
        .radar-chart-container {
            width: 100%;
            text-align: center;
            margin-bottom: 15px;
            background-color: var(--card-bg-color);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .radar-title {
            font-size: 1.3em;
            margin: 0 0 10px 0;
            color: var(--primary-text-color);
            font-weight: 600;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 6px 12px;
            background-color: var(--event-section-bg-color);
            border-radius: 4px;
            font-size: 0.95em;
            margin-bottom: 15px;
            color: var(--secondary-text-color);
            font-weight: 500;
        }
        
        .radar-chart {
            max-height: 350px;
            width: 100%;
            max-width: 500px;
        }
        
        .radar-level {
            fill: transparent;
            stroke: var(--radar-line-color);
            stroke-width: 1;
        }
        
        .radar-axis {
            stroke: var(--radar-line-color);
            stroke-width: 1;
        }
        
        .radar-label {
            font-size: 14px;
            font-weight: 500;
            fill: var(--primary-text-color);
        }
        
        .radar-scale {
            font-size: 11px;
            fill: var(--secondary-text-color);
        }
        
        .radar-data {
            fill: var(--radar-data-fill);
            stroke: var(--radar-data-stroke);
            stroke-width: 2;
        }
        
        .radar-point {
            fill: var(--radar-point-color);
            stroke: white;
            stroke-width: 1;
        }
        
        body.dark-mode .radar-level,
        body.dark-mode .radar-axis {
            stroke: #5d7083;
        }
        
        body.dark-mode .radar-label,
        body.dark-mode .radar-scale {
            fill: #ecf0f1;
        }
    </style>
</head>
<body>
    <button id="themeToggle" class="theme-toggle-button">ğŸŒ™/â˜€ï¸</button>
    <div class="container">
        <header>
            <h1>ã€Šåäººå°ç»„ - æœªæ¥è¿œå¾æ¨¡æ‹Ÿã€‹V0.8</h1>
            <p id="currentYearDisplay">å¹´ä»½ï¼š2025</p>
            <p id="phaseDisplay">é˜¶æ®µï¼šåˆå§‹Â·å¥ åŸºæœŸ (2025)</p>
        </header>

        <div id="statusDashboard">
            </div>

        <div id="eventSection">
            <h2 id="eventTitle">æ¬¢è¿æ¥åˆ°ã€Šåäººå°ç»„ - æœªæ¥è¿œå¾æ¨¡æ‹Ÿã€‹</h2>
            <p id="eventDescription">
                æ‚¨å’Œæ‚¨çš„å›¢é˜Ÿå°†å…±åŒå¯¼èˆªã€Šåäººå°ç»„ã€‹(TPG)é¡¹ç›®ä»2025å¹´è‡³2030å¹´çš„å‘å±•é“è·¯ã€‚<br>
                æ¯ä¸ªâ€œå›åˆâ€ä»£è¡¨ä¸€ä¸ªå…³é”®çš„å‘å±•é˜¶æ®µæˆ–å¹´ä»½ï¼Œæ‚¨å°†é¢ä¸´ä¸€ä¸ªæ ¸å¿ƒäº‹ä»¶ï¼Œå¹¶éœ€è¦å…±åŒåšå‡ºæˆ˜ç•¥å†³ç­–ã€‚<br>
                æ‚¨çš„å†³ç­–å°†ç›´æ¥å½±å“å›¢é˜Ÿçš„å…­å¤§æ ¸å¿ƒçŠ¶æ€ï¼Œå¹¶å¯èƒ½è§¦å‘è¿é”ååº”â€”â€”è¿™å°±æ˜¯â€œè´¢å¯Œæµæ²™ç›˜æ•ˆåº”â€ã€‚<br>
                ä»”ç»†è®¨è®ºï¼Œæ˜æ™ºé€‰æ‹©ï¼ŒåŠªåŠ›å®ç°å›¢é˜Ÿçš„æ„¿æ™¯ï¼
            </p>
            <div id="choicesContainer">
                </div>
            <p id="feedbackText">ç‚¹å‡»â€œå¼€å§‹è¿œå¾â€ä»¥è§¦å‘ç¬¬ä¸€ä¸ªäº‹ä»¶ã€‚</p>
        </div>
        
        <div id="gameOverMessage" style="display:none;"></div>

        <div class="controls">
            <button id="nextButton">å¼€å§‹è¿œå¾</button>
            <button id="restartButton" style="display:none;">é‡æ–°å¼€å§‹</button>
        </div>

        <div id="gameLogSection">
            <h2>å†³ç­–æ—¥å¿—</h2>
            <ul id="gameLogUl"></ul>
        </div>
    </div>

    <script src="radar-chart.js"></script>
    <script>
        // --- Game State Definition ---
        let gameState = {
            currentYear: 2025,
            phase: "åˆå§‹Â·å¥ åŸºæœŸ (2025)",
            turn: 0,
            maxTurns: 6,

            financialHealth: 50,    
            monthlyBurnRate: 10000, 
            teamEffectiveness: 50,  
            productStrength: 50,    
            productInnovation: 5,   // 0-10 scale
            marketPosition: 25,     
            brandReputation: 50,    // 0-100 scale
            businessViability: 30,  
            communityPointsPool: 100, 
            communitySize: 1500,
            communityEngagement: 10, // Percentage
            contributorsCount: 10,
            contributorMorale: 6, // 0-10 scale
            pointsSystemStatus: "ç­¹å¤‡ä¸­",
            visionExecution: 50,    
            specialStatus: ["æ„¿æ™¯å°šåœ¨æ¢ç´¢æœŸ", "èµ„é‡‘ç›¸å¯¹å……è£•"], 

            currentEvent: null,
            eventHistory: [], 
            gameOver: false,
            gameOverReason: "", 
            gameLog: [] 
        };
        const initialGameState = JSON.parse(JSON.stringify(gameState)); 

        // --- Game State Getters (for descriptive text) ---
        const gameStateGetters = {
            getFinancialHealthDescription: (gs) => {
                const score = gs.financialHealth;
                const conceptualMaxFunds = 90000; 
                const currentConceptualFunds = (score / 100) * conceptualMaxFunds;
                const monthsSustainable = gs.monthlyBurnRate > 0 ? Math.floor(currentConceptualFunds / gs.monthlyBurnRate) : Infinity;
                
                let runwayText = monthsSustainable === Infinity ? "(æå……è£•)" : `(${monthsSustainable}ä¸ªæœˆæ”¯æ’‘)`;
                if (score <= 10) runwayText = "(<1ä¸ªæœˆæ”¯æ’‘!)"; 

                if (score <= 10) return `å·²ç ´äº§ ğŸ’” ${runwayText}`;        
                if (score < 20) return `æ¿’ä¸´ç ´äº§ ğŸ’€ ${runwayText}`;     
                if (score < 30) return `æåº¦ç´§å¼  ğŸ˜° ${runwayText}`; 
                if (score < 40) return `ç´§å¼  ğŸ˜Ÿ ${runwayText}`;     
                if (score < 50) return `ç•¥æœ‰å‚¨å¤‡ ğŸ¤” ${runwayText}`; 
                if (score < 70) return `å°šå¯ç¨³å®š ğŸ˜Š ${runwayText}`;
                return `å……è£•å¥åº· ğŸ’° ${runwayText}`;
            },
            getTeamEffectivenessDescription: (gs) => {
                const score = gs.teamEffectiveness;
                let moraleDesc = `è´¡çŒ®è€…(${gs.contributorsCount}äºº,å£«æ°”${gs.contributorMorale}/10)`;
                if (score <= 20) return `æ¿’ä¸´è§£ä½“ ğŸ’” (${moraleDesc})`; 
                if (score < 45) return `æ•ˆç‡ä½ä¸‹ ğŸ˜“ (${moraleDesc})`;
                if (score < 75) return `åŸºæœ¬è¿è½¬ ğŸ‘ (${moraleDesc})`;
                return `é«˜æ•ˆååŒ ğŸ”¥ (${moraleDesc})`;
            },
            getProductStrengthDescription: (gs) => {
                const score = gs.productStrength;
                let innovationDesc = `åˆ›æ–°åŠ›(${gs.productInnovation}/10)`;
                if (score < 25) return `æ— å¸å¼•åŠ› ğŸ“‰ (${innovationDesc})`;
                if (score < 45) return `åŠŸèƒ½å¹³åº¸ ğŸ˜ (${innovationDesc})`;
                if (score < 75) return `æœ‰ç«äº‰åŠ› âœ¨ (${innovationDesc})`;
                return `å¸‚åœºé¢†å…ˆ ğŸš€ (${innovationDesc})`;
            },
            getMarketPositionDescription: (gs) => {
                const score = gs.marketPosition;
                let reputationDesc = `å£°èª‰(${gs.brandReputation}/100)`;
                let communityDesc = `ç¤¾ç¾¤(${gs.communitySize}äºº,æ´»${gs.communityEngagement}%)`;
                if (score < 20) return `è¾¹ç¼˜åŒ–/è¢«é—å¿˜ ğŸŒ«ï¸ (${reputationDesc}, ${communityDesc})`;
                if (score < 40) return `å‚ä¸è€…/è®¤çŸ¥åº¦ä½ ğŸ‘€ (${reputationDesc}, ${communityDesc})`;
                if (score < 70) return `æœ‰åŠ›ç«äº‰è€…/æœ‰å£ç¢‘ ğŸŒŸ (${reputationDesc}, ${communityDesc})`;
                return `é¢†å¯¼è€…/çŸ¥å ğŸ‘‘ (${reputationDesc}, ${communityDesc})`;
            },
            getBusinessViabilityDescription: (gs) => {
                const score = gs.businessViability;
                let pointsDesc = `ç§¯åˆ†(${gs.pointsSystemStatus}), å…¬å…±åŸºé‡‘(${gs.communityPointsPool}ç‚¹)`;
                if (score < 20) return `æ— æ³•é€ è¡€ ğŸ’” (${pointsDesc})`;
                if (score < 40) return `æ¨¡ç³Šé«˜é£é™© ğŸ² (${pointsDesc})`;
                if (score < 70) return `æ¢ç´¢éªŒè¯ä¸­ ğŸ’¡ (${pointsDesc})`;
                return `æˆç†Ÿå¯æŒç»­ ğŸŒ± (${pointsDesc})`;
            },
            getVisionExecutionDescription: (gs) => {
                const score = gs.visionExecution;
                let statusText = gs.specialStatus.length > 0 ? ` (${gs.specialStatus.join(', ')})` : "";
                if (score < 25) return `ä¸¥é‡èƒŒç¦»ï¼Œåˆå¿ƒå·²å¤± ğŸ§­âŒ${statusText}`;
                if (score < 45) return `å‡ºç°åç¦» ğŸš§${statusText}`;
                if (score < 75) return `åŸºæœ¬éµå¾ªï¼Œå¶æœ‰è°ƒæ•´ ğŸ‘${statusText}`;
                return `é«˜åº¦å¥‘åˆï¼Œç¨³æ­¥æ¨è¿› ğŸ¯${statusText}`;
            }
        };

        // --- Event Library (6 Core Events with MAGNIFIED and BALANCED effects) ---
        const eventLibrary = [
            { // Event 1 - 2025
                id: "TPG_SIM_2025_MVP_CHOICE",
                title: "2025ï¼šå¯èˆªä¹‹å¹´ - MVPçš„åå­—è·¯å£",
                description: "ã€Šåäººå°ç»„ã€‹çš„ç¬¬ä¸€ä¸ªMVPï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªåŸºç¡€ç‰ˆçš„çº¿ä¸‹å·¥ä½œåŠä½“éªŒæµç¨‹ï¼‰ç»è¿‡å°èŒƒå›´æµ‹è¯•åï¼Œæ”¶åˆ°çš„ç”¨æˆ·åé¦ˆå–œå¿§å‚åŠã€‚ä¸€éƒ¨åˆ†æ ¸å¿ƒçˆ±å¥½è€…å¯¹å…¶æ·±åº¦å’Œæ½œåŠ›è¡¨ç¤ºèµèµï¼Œä½†æ›´å¤šæ™®é€šç”¨æˆ·è§‰å¾—â€˜é—¨æ§›åé«˜â€™æˆ–â€˜ä¸æˆ‘æœ€åˆçš„æœŸå¾…ä¸ç¬¦â€™ã€‚å›¢é˜Ÿé¢ä¸´å…³é”®æŠ‰æ‹©ï¼šæ˜¯åšæŒæ‰“ç£¨ç°æœ‰æ ¸å¿ƒä½“éªŒï¼Œè¿˜æ˜¯æ ¹æ®å¤§ä¼—åé¦ˆè¿›è¡Œæ›´â€˜æ¥åœ°æ°”â€™çš„è°ƒæ•´ï¼Œæˆ–æ˜¯æŠ•å…¥æ›´å¤šç²¾åŠ›æ•™è‚²å¸‚åœºï¼Ÿ",
                yearTriggerMin: 2025, yearTriggerMax: 2025,
                triggered: false,
                choices: [
                    {
                        text: "åšå®ˆæ ¸å¿ƒï¼Œæ·±åŒ–ä½“éªŒ",
                        effects: function(gs) {
                            let changes = []; let oldVal;
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 20); changes.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 3); changes.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 12); changes.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 15); changes.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Increased cost
                            oldVal = gs.marketPosition; gs.marketPosition = Math.max(0, gs.marketPosition - 10); changes.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.max(0, gs.brandReputation - 8); changes.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 20); changes.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("æ ¸å¿ƒä½“éªŒæè‡´æ‰“ç£¨")) gs.specialStatus.push("æ ¸å¿ƒä½“éªŒæè‡´æ‰“ç£¨");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "äº§å“æ–¹å‘å¤§ä¼—åŒ–è°ƒæ•´" && s !== "å¸‚åœºåŸ¹è‚²å¼ºåŒ–");
                            return `å±æ€§å˜åŒ–ï¼š${changes.join('ï¼›')}ã€‚è¿é”ååº”ï¼šäº§å“ç‹¬ç‰¹æ€§å’Œåˆ›æ–°åŠ›å¤§å¹…å¢å¼ºï¼Œå›¢é˜Ÿå› åšæŒæ„¿æ™¯è€Œå£«æ°”é«˜æ¶¨ã€‚ä½†è´¢åŠ¡æ¶ˆè€—å¢åŠ ï¼Œä¸”çŸ­æœŸå†…å¤§ä¼—å¸‚åœºæ‹“å±•æ›´ä¸ºç¼“æ…¢ï¼Œå“ç‰Œå£°èª‰é¢ä¸´å°ä¼—åŒ–æŒ‘æˆ˜ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿå†³å®šä¸ä¸ºæ‰€åŠ¨ï¼ŒåŠ å€æŠ•å…¥èµ„æºæ·±æŒ–æ ¸å¿ƒä½“éªŒçš„æŠ¤åŸæ²³ï¼è¿™èµ¢å¾—äº†æ—©æœŸæ ¸å¿ƒç”¨æˆ·çš„ç‹‚çƒ­èµèª‰ï¼Œä½†ä¹Ÿæ„å‘³ç€éœ€è¦æ›´é•¿æ—¶é—´çš„å¸‚åœºåŸ¹è‚²å’Œæ›´ç²¾å‡†çš„ç”¨æˆ·å®šä½ï¼Œè´¢åŠ¡å‹åŠ›æœ‰æ‰€å¢åŠ ã€‚"
                    },
                    {
                        text: "æ•æ·è°ƒæ•´ï¼Œæ‹¥æŠ±åé¦ˆ",
                        effects: function(gs) {
                            let changes = []; let oldVal;
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 10); changes.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.max(0, gs.productInnovation - 2); changes.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 18); changes.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Significant cost
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.max(0, gs.teamEffectiveness - 15); changes.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 20); changes.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.communitySize; gs.communitySize += Math.floor(gs.communitySize * 0.20); changes.push(`ç¤¾ç¾¤è§„æ¨¡ ${oldVal} -> ${gs.communitySize}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.min(100, gs.brandReputation + 10); changes.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 15); changes.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.max(0, gs.visionExecution - 20); changes.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("äº§å“å¤§ä¼—åŒ–è½¬å‹")) gs.specialStatus.push("äº§å“å¤§ä¼—åŒ–è½¬å‹");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "æ ¸å¿ƒä½“éªŒæè‡´æ‰“ç£¨" && s !== "å¸‚åœºåŸ¹è‚²å¼ºåŒ–");
                            return `å±æ€§å˜åŒ–ï¼š${changes.join('ï¼›')}ã€‚è¿é”ååº”ï¼šäº§å“æ›´è´´è¿‘å¤§ä¼—ï¼Œå¯èƒ½åŠ é€Ÿç”¨æˆ·è·å–å’Œå•†ä¸šæ¨¡å¼éªŒè¯ï¼Œä½†ä¹Ÿå¯èƒ½å¤±å»æ ¸å¿ƒæ·±åº¦ç”¨æˆ·åŠåˆ›æ–°ç‹¬ç‰¹æ€§ã€‚å›¢é˜Ÿå†…éƒ¨å¯¹æ–¹å‘è°ƒæ•´æœ‰è¾ƒå¤§ç–‘è™‘ï¼ŒçŸ­æœŸæ•ˆèƒ½æ˜¾è‘—ä¸‹é™ï¼Œè´¢åŠ¡æŠ•å…¥å‰§å¢ï¼Œä¸”æ„¿æ™¯æ‰§è¡Œå‡ºç°ä¸¥é‡åç¦»ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿè¿…é€Ÿå“åº”å¸‚åœºåé¦ˆï¼Œå¯¹MVPè¿›è¡Œäº†å¤§åˆ€æ–§é˜”çš„æ”¹é©ä»¥æ±‚æ›´å¹¿æ³›çš„æ¥å—åº¦ï¼è¿™å¯èƒ½å¸å¼•æ›´å¤šæ–°ç”¨æˆ·ï¼Œä½†ä¹Ÿå¼•å‘äº†å…³äºæ˜¯å¦å¤±å»TPGçµé­‚çš„æ¿€çƒˆè®¨è®ºï¼Œå›¢é˜Ÿå£«æ°”å—åˆ°ä¸¥é‡å½±å“ã€‚"
                    },
                    {
                        text: "æ•™è‚²å¸‚åœºï¼Œç­‰å¾…èŠ±å¼€",
                        effects: function(gs) {
                            let changes = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 15); changes.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Increased cost
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 8); changes.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 12); changes.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.min(100, gs.brandReputation + 15); changes.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.max(0, gs.businessViability - 12); changes.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`); // More uncertainty
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 10); changes.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("å¸‚åœºåŸ¹è‚²å¼ºåŒ–")) gs.specialStatus.push("å¸‚åœºåŸ¹è‚²å¼ºåŒ–");
                             gs.specialStatus = gs.specialStatus.filter(s => s !== "æ ¸å¿ƒä½“éªŒæè‡´æ‰“ç£¨" && s !== "äº§å“å¤§ä¼—åŒ–è½¬å‹");
                            return `å±æ€§å˜åŒ–ï¼š${changes.join('ï¼›')}ã€‚è¿é”ååº”ï¼šè‹¥å¸‚åœºæ•™è‚²æˆåŠŸï¼Œèƒ½æå‡ç”¨æˆ·å¯¹äº§å“ä»·å€¼çš„è®¤çŸ¥ï¼Œå·©å›ºå¸‚åœºåœ°ä½ã€‚ä½†è´¢åŠ¡æŠ•å…¥è¾ƒå¤§ï¼Œä¸”çŸ­æœŸå†…å•†ä¸šæ¨¡å¼è½¬åŒ–ä¸ç¡®å®šæ€§å¢åŠ ï¼Œè€ƒéªŒå›¢é˜Ÿè€å¿ƒå’Œèµ„é‡‘å‚¨å¤‡ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿç›¸ä¿¡é…’é¦™ä¹Ÿæ€•å··å­æ·±ï¼Œå†³å®šæŠ•å…¥æ›´å¤šèµ„æºè¿›è¡Œå¸‚åœºæ•™è‚²ï¼Œæå‡å“ç‰Œå£°èª‰ï¼è¿™éœ€è¦è€å¿ƒå’ŒæŒç»­çš„æŠ•å…¥ï¼ŒçŸ­æœŸå†…è´¢åŠ¡å‹åŠ›å¢åŠ ï¼Œæ•ˆæœå¦‚ä½•å°šå¾…å¸‚åœºæ£€éªŒã€‚"
                    }
                ]
            },
            { // Event 2 - 2026
                id: "TPG_SIM_2026_TEAM_ENGINE",
                title: "2026ï¼šå›¢é˜Ÿçš„å¼•æ“ - å…¼èŒå›°å¢ƒä¸æ¿€åŠ±æŠ‰æ‹©",
                description: (gs) => `TPGçš„å‘å±•åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºå…¼èŒæˆå‘˜çš„çƒ­æƒ…å’Œè´¡çŒ®ã€‚ç„¶è€Œï¼Œâ€œæŒ‰åœºæ¬¡/è®¡ä»¶ä»˜è´¹â€çš„å•ä¸€æ¿€åŠ±æ¨¡å¼å¼€å§‹æ˜¾ç°ç–²æ€ã€‚ä¸€äº›æ ¸å¿ƒå…¼èŒæˆå‘˜ï¼ˆå½“å‰çº¦${gs.contributorsCount}åï¼Œå£«æ°”${gs.contributorMorale}/10ï¼‰å› ç¼ºä¹é•¿æœŸçš„å½’å±æ„Ÿã€æˆé•¿ç©ºé—´æˆ–ä¸é¡¹ç›®æ›´æ·±åº¦çš„åˆ©ç›Šç»‘å®šï¼Œå‚ä¸çš„ç¨³å®šæ€§å’Œäº§å‡ºè´¨é‡å¼€å§‹æ³¢åŠ¨ã€‚`,
                yearTriggerMin: 2026, yearTriggerMax: 2026, triggered: false,
                choices: [
                    {
                        text: "å¼ºåŒ–çŸ­æœŸç°é‡‘æ¿€åŠ±",
                        effects: function(gs) {
                            let changes = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 20); changes.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Magnified cost
                            oldVal = gs.monthlyBurnRate; gs.monthlyBurnRate += 3000; changes.push(`æœˆåº¦è¿è¥æˆæœ¬ ${oldVal} -> ${gs.monthlyBurnRate}`);
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 10); changes.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); // Larger short term boost
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.min(10, gs.contributorMorale + 3); changes.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 5); changes.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.max(0, gs.businessViability - 18); changes.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`); // Bigger hit to viability
                            oldVal = gs.visionExecution; gs.visionExecution = Math.max(0, gs.visionExecution - 12); changes.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("é«˜è–ªé›‡ä½£å…µæ¨¡å¼")) gs.specialStatus.push("é«˜è–ªé›‡ä½£å…µæ¨¡å¼");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "ç§¯åˆ†ä½“ç³»æ¢ç´¢ä¸­" && s !== "æ ¸å¿ƒè´¡çŒ®è€…ä¼™ä¼´è®¡åˆ’");
                            return `å±æ€§å˜åŒ–ï¼š${changes.join('ï¼›')}ã€‚è¿é”ååº”ï¼šè´¢åŠ¡å‹åŠ›å‰§å¢ï¼Œå›¢é˜Ÿæ–‡åŒ–æ›´è¶‹åŠŸåˆ©å’ŒçŸ­æœŸåŒ–ï¼Œä¸¥é‡å‹ç¼©åˆ©æ¶¦ç©ºé—´å¹¶å¯èƒ½æŸå®³éœ€è¦é•¿æœŸæŠ•å…¥çš„åˆ›æ–°å’Œæ·±åº¦å†…å®¹ï¼Œä½¿æ„¿æ™¯æ‰§è¡Œåç¦»ç¤¾ç¾¤å…±å»ºã€‚`;
                        },
                        feedback: "å¤§å¹…æé«˜ç°é‡‘æ¿€åŠ±çŸ­æœŸå†…æ˜¾è‘—åˆºæ¿€äº†å…¼èŒæˆå‘˜çš„æ´»è·ƒåº¦ï¼Œä½†ä¹Ÿä½¿å›¢é˜Ÿçš„è´¢åŠ¡çŠ¶å†µé›ªä¸ŠåŠ éœœï¼Œç¤¾ç¾¤æ°›å›´ä¹Ÿæ›´åå‘çŸ­æœŸåˆ©ç›Šé©±åŠ¨ï¼Œæ ¸å¿ƒå›¢é˜Ÿå¯¹æ­¤æ„Ÿåˆ°å¿§è™‘ã€‚"
                    },
                    {
                        text: "ç³»ç»ŸåŒ–ç¤¾åŒºç§¯åˆ†ä¸æƒç›Šä½“ç³»",
                        effects: function(gs) {
                            let changes = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 5); changes.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Slightly increased cost for system setup
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 20); changes.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); // Magnified
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.min(10, gs.contributorMorale + 4); changes.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.contributorsCount; gs.contributorsCount = Math.min(gs.contributorsCount + 5, 30); changes.push(`è´¡çŒ®è€…æ•°é‡ ${oldVal} -> ${gs.contributorsCount}`); // More attraction
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 12); changes.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 2); changes.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 15); changes.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.communityEngagement; gs.communityEngagement = Math.min(100, gs.communityEngagement + 30); changes.push(`ç¤¾ç¾¤æ´»è·ƒåº¦ ${oldVal}% -> ${gs.communityEngagement}%`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 15); changes.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            gs.pointsSystemStatus = "V1.0 ç¤¾åŒºå…±å»ºæ ¸å¿ƒ"; changes.push(`ç§¯åˆ†ä½“ç³»çŠ¶æ€ -> ${gs.pointsSystemStatus}`);
                            oldVal = gs.communityPointsPool; gs.communityPointsPool += 1000; changes.push(`ç¤¾åŒºç§¯åˆ†æ±  ${oldVal} -> ${gs.communityPointsPool}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 25); changes.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("ç¤¾ç¾¤æ¿€åŠ±ä½“ç³»æˆç†Ÿ")) gs.specialStatus.push("ç¤¾ç¾¤æ¿€åŠ±ä½“ç³»æˆç†Ÿ");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "é«˜è–ªé›‡ä½£å…µæ¨¡å¼" && s !== "æ ¸å¿ƒè´¡çŒ®è€…ä¼™ä¼´è®¡åˆ’");
                            return `å±æ€§å˜åŒ–ï¼š${changes.join('ï¼›')}ã€‚è¿é”ååº”ï¼šæ˜¾è‘—æå‡ç¤¾ç¾¤ç²˜æ€§ã€è´¡çŒ®è´¨é‡å’Œæ•°é‡ï¼Œä¸ºTPGæ³¨å…¥å¼ºå¤§æ´»åŠ›ï¼Œå¹¶å·©å›ºç¤¾ç¾¤é©±åŠ¨çš„å•†ä¸šæ¨¡å¼ã€‚ä½†è¿™éœ€è¦æŒç»­çš„è¿è¥æŠ•å…¥å’Œæ‰¿è¯ºå…‘ç°ï¼Œè‹¥åç»­å¥–åŠ±æ— æ³•æ»¡è¶³é¢„æœŸï¼Œå¯èƒ½å¯¼è‡´ä¿¡ä»»å—æŸã€‚`;
                        },
                        feedback: "ç¤¾åŒºç§¯åˆ†ä¸æƒç›Šä½“ç³»V1.0æ­£å¼ä¸Šçº¿å¹¶è·å¾—çƒ­çƒˆåå“ï¼æ¸…æ™°çš„é•¿æœŸå›æŠ¥é¢„æœŸã€ä¸°å¯Œçš„å…‘æ¢é€‰é¡¹å’Œç¤¾ç¾¤è£èª‰æ„Ÿï¼Œæå¤§åœ°æ¿€å‘äº†è´¡çŒ®è€…çš„çƒ­æƒ…å’Œåˆ›é€ åŠ›ï¼Œç¤¾ç¾¤æ´»è·ƒåº¦å’Œäº§å‡ºè´¨é‡æ˜¾è‘—æå‡ã€‚"
                    },
                    {
                        text: "æ ¸å¿ƒè´¡çŒ®è€…ä¼™ä¼´åŒ–",
                        effects: function(gs) {
                            let changes = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 10); changes.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Increased cost for meaningful partnership terms
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 20); changes.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.min(10, gs.contributorMorale + 5); changes.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`); // For core
                            gs.contributorsCount = Math.max(gs.contributorsCount -1, 5); // Some non-core might feel left out
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 18); changes.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 3); changes.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 15); changes.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("æ ¸å¿ƒè´¡çŒ®è€…ä¼™ä¼´è®¡åˆ’")) gs.specialStatus.push("æ ¸å¿ƒè´¡çŒ®è€…ä¼™ä¼´è®¡åˆ’");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "é«˜è–ªé›‡ä½£å…µæ¨¡å¼" && s !== "ç§¯åˆ†ä½“ç³»æ¢ç´¢ä¸­");
                            return `å±æ€§å˜åŒ–ï¼š${changes.join('ï¼›')}ã€‚è¿é”ååº”ï¼šæå¤§ç¨³å®šäº†æ ¸å¿ƒäº§å‡ºå’Œå…³é”®äººæ‰ï¼Œæå‡äº†äº§å“ç«äº‰åŠ›ä¸åˆ›æ–°èƒ½åŠ›ã€‚ä½†ä¹Ÿå¯èƒ½åœ¨éä¼™ä¼´çš„å…¼èŒæˆå‘˜ä¸­äº§ç”Ÿæ–°çš„æœŸæœ›æˆ–ä¸å¹³è¡¡æ„Ÿï¼Œéœ€åç»­å…³æ³¨å’Œç®¡ç†ï¼Œå¯èƒ½å¯¹è´¡çŒ®è€…æ€»æ•°æœ‰è½»å¾®è´Ÿé¢å½±å“ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿå†³å®šä¸æœ€æ ¸å¿ƒçš„å‡ ä½è´¡çŒ®è€…ç­¾è®¢ä¼™ä¼´åè®®ï¼Œæä¾›æ›´ä¼˜åšçš„æ¡ä»¶ã€æ›´æ·±åº¦çš„é¡¹ç›®å‚ä¸æƒä»¥åŠæœªæ¥æ½œåœ¨çš„æ”¶ç›Šåˆ†äº«ï¼è¿™æå¤§åœ°æå‡äº†ä»–ä»¬çš„å½’å±æ„Ÿå’ŒæŠ•å…¥åº¦ï¼Œä½†ä¹Ÿéœ€è¦å›¢é˜Ÿå®¡æ…å¤„ç†ä¸å…¶ä»–è´¡çŒ®è€…çš„å…³ç³»ï¼Œé¿å…äº§ç”Ÿéš”é˜‚ã€‚"
                    }
                ]
            },
            { // Event 3 - 2027
                id: "TPG_SIM_2027_BIG_DEAL",
                title: "2027ï¼šå•†ä¸šçš„æ©„æ¦„æ - â€œå¤§å•â€çš„è¯±æƒ‘ä¸é™·é˜±",
                description: "TPGè¿æ¥ä¸€ä¸ªæ½œåœ¨çš„â€˜å¤§è®¢å•â€™ï¼ä¸€å®¶é¢‡å…·å®åŠ›çš„ä¼ä¸šå¸Œæœ›å®šåˆ¶ä¸€ç³»åˆ—é«˜ä»·å€¼ä½“éªŒæ´»åŠ¨ã€‚è®¢å•èƒ½æå¤§æ”¹å–„è´¢åŠ¡ï¼ˆé¢„è®¡æ”¶ç›Šèƒ½è¦†ç›–åŠå¹´è¿è¥æˆæœ¬ï¼‰å¹¶æå‡å¸‚åœºåœ°ä½ï¼Œä½†å¯¹æ–¹éœ€æ±‚ä¸TPGæ ¸å¿ƒç†å¿µå­˜åœ¨ä¸€å®šå·®å¼‚ï¼Œä¸”é¡¹ç›®å‘¨æœŸæç´§ï¼Œå¯¹å›¢é˜Ÿç²¾åŠ›æ˜¯å·¨å¤§è€ƒéªŒã€‚",
                yearTriggerMin: 2027, yearTriggerMax: 2027, triggered: false,
                choices: [
                    {
                        text: "å…¨åŠ›ä»¥èµ´ï¼Œæ‹¿ä¸‹å¤§å•",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.min(100, gs.financialHealth + 40); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`);
                            oldVal = gs.monthlyBurnRate; gs.monthlyBurnRate -= 2000; c.push(`æœˆåº¦è¿è¥æˆæœ¬ ${oldVal} -> ${gs.monthlyBurnRate}`);
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.max(0, gs.teamEffectiveness - 25); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.max(0, gs.contributorMorale - 4); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.max(0, gs.productStrength - 15); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.max(0, gs.productInnovation - 2); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 30); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.min(100, gs.brandReputation + 25); c.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 20); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.max(0, gs.visionExecution - 30); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("B2Bå¤§å®¢æˆ·æ·±åº¦ç»‘å®š")) gs.specialStatus.push("B2Bå¤§å®¢æˆ·æ·±åº¦ç»‘å®š");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "B2Bæ¨¡å¼éªŒè¯æ€§æˆåŠŸ");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šçŸ­æœŸè´¢åŠ¡çŠ¶å†µæå¤§æ”¹å–„ï¼Œå¸‚åœºåœ°ä½æ˜¾è‘—æå‡ã€‚ä½†å›¢é˜Ÿæ•ˆèƒ½å› è¿‡åº¦é€æ”¯è€Œä¸¥é‡ä¸‹é™ï¼Œæ ¸å¿ƒäº§å“åˆ›æ–°åœæ»ï¼Œä¸”é¡¹ç›®æ–¹å‘è¢«å¤§å®¢æˆ·æ·±åº¦ç»‘å®šï¼Œä¸¥é‡åç¦»åŸæœ‰æ„¿æ™¯ï¼Œå¢åŠ äº†æœªæ¥å•ä¸€å®¢æˆ·ä¾èµ–å’Œå›¢é˜Ÿæ ¸å¿ƒä»·å€¼è¿·å¤±çš„å·¨å¤§é£é™©ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿå†³å®šèµŒä¸Šä¸€åˆ‡ï¼Œæ‹¿ä¸‹è¿™ä¸ªå¤§å•ï¼æ»šæ»šè´¢æºæ¶Œå…¥ï¼Œå¸‚åœºçŸ¥ååº¦å¤§å¢ï¼Œä½†ä¹Ÿè®©å›¢é˜Ÿæˆå‘˜ä»¬èº«å¿ƒä¿±ç–²ï¼ŒTPGçš„æ ¸å¿ƒäº§å“å’Œç¤¾ç¾¤ä¼¼ä¹è¢«æš‚æ—¶é—å¿˜ï¼Œèˆªå‘å‘ç”Ÿäº†å‰§çƒˆçš„åè½¬..."
                    },
                    {
                        text: "è°ˆåˆ¤ä¸å¼•å¯¼ï¼Œäº‰å–åŒèµ¢",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.min(100, gs.financialHealth + 18); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Still good gain
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 10); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 12); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 1); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 15); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.min(100, gs.brandReputation + 15); c.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 18); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 10); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("B2Bæˆ˜ç•¥åˆä½œçªç ´")) gs.specialStatus.push("B2Bæˆ˜ç•¥åˆä½œçªç ´");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "é«˜å¼ºåº¦B2Bé¡¹ç›®äº¤ä»˜ä¸­");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šè™½ç„¶çŸ­æœŸæ”¶ç›Šä¸å¦‚ALL INï¼Œä½†æ›´å¥½åœ°ä¿æŠ¤äº†å›¢é˜Ÿå’Œæ„¿æ™¯ï¼ŒéªŒè¯äº†å¥åº·çš„B2Båˆä½œæ¨¡å¼ï¼Œä¸ºå•†ä¸šæ¨¡å¼é•¿æœŸå‘å±•å’Œäº§å“ç«äº‰åŠ›æå‡æ‰“ä¸‹è‰¯å¥½åŸºç¡€ï¼Œå›¢é˜Ÿèƒ½åŠ›å¾—åˆ°é”»ç‚¼ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿå±•ç°äº†é«˜è¶…çš„æ²Ÿé€šä¸æ–¹æ¡ˆèƒ½åŠ›ï¼é€šè¿‡ä¸ç”²æ–¹çš„ç§¯æåå•†ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªæ—¢èƒ½æ»¡è¶³å¯¹æ–¹æ ¸å¿ƒéœ€æ±‚ï¼Œåˆèƒ½å……åˆ†å‘æŒ¥TPGè‡ªèº«ä¼˜åŠ¿çš„åˆä½œæ¨¡å¼ã€‚è¿™ä¸ä»…å¸¦æ¥äº†å¯è§‚çš„æ”¶ç›Šï¼Œæ›´ä¸ºTPGçš„B2Bä¹‹è·¯ç§¯ç´¯äº†å®è´µä¸”æ­£å‘çš„ç»éªŒã€‚"
                    },
                    {
                        text: "å®¡æ…è¯„ä¼°ï¼Œå©‰æ‹’ä¸ç¬¦æœºä¼š",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 5); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Clearer opportunity cost
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 12); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 10); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 1); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 25); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "é«˜å¼ºåº¦B2Bé¡¹ç›®äº¤ä»˜ä¸­" && s !== "B2Båˆä½œæ¨¡å¼æ¢ç´¢æˆåŠŸ");
                            if (!gs.specialStatus.includes("åšå®ˆæ ¸å¿ƒä»·å€¼ä¸æˆ˜ç•¥å®šåŠ›")) gs.specialStatus.push("åšå®ˆæ ¸å¿ƒä»·å€¼ä¸æˆ˜ç•¥å®šåŠ›");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šè™½ç„¶çŸ­æœŸå†…é”™å¤±äº†ä¸€å¤§ç¬”æ”¶å…¥ï¼Œè´¢åŠ¡å‹åŠ›æŒç»­ï¼Œä½†åšå®ˆæ ¸å¿ƒæ„¿æ™¯æå¤§åœ°å‡èšäº†å›¢é˜Ÿï¼Œå¹¶ä¸ºé•¿æœŸå“ç‰Œå»ºè®¾å’Œäº§å“ç«äº‰åŠ›çš„æ·±åº¦æ‰“ç£¨èµ¢å¾—å®è´µæ—¶é—´ä¸ä¸“æ³¨ã€‚è¿™å¯èƒ½å¸å¼•åˆ°æ›´å¥‘åˆçš„æœªæ¥æœºä¼šã€‚`;
                        },
                        feedback: "å›¢é˜Ÿè®¤ä¸ºè¿™ä¸ªâ€˜å¤§å•â€™çš„é£é™©å’Œä»£ä»·ï¼ˆç‰¹åˆ«æ˜¯å¯¹æ„¿æ™¯çš„åç¦»ï¼‰è¿‡é«˜ï¼Œå†³å®šå©‰æ‹’ï¼Œç»§ç»­æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥æ·±è€•æ ¸å¿ƒä¸šåŠ¡ã€‚è¿™éœ€è¦æå¤§çš„å‹‡æ°”å’Œå¯¹è‡ªèº«æˆ˜ç•¥çš„ä¿¡å¿ƒï¼Œå›¢é˜Ÿå†…éƒ¨å¯¹æ­¤å†³å®šé«˜åº¦è®¤åŒï¼Œå£«æ°”å¾—åˆ°é¼“èˆã€‚"
                    }
                ]
            },
            { // Event 4 - 2028
                id: "TPG_SIM_2028_COMPETITION_INTERNAL",
                title: "2028ï¼šå†…å¤–äº¤å›° - å¸‚åœºæ¨¡ä»¿è€…ä¸å†…éƒ¨æˆé•¿é˜µç—›",
                description: (gs) => `TPGçš„æ ¸å¿ƒè§„åˆ™/æ¨¡å¼å¼€å§‹è¢«å¸‚åœºæ¨¡ä»¿ï¼Œå‡ºç°ä½ä»·ç«äº‰è€…ï¼Œå¯¹å¸‚åœºåœ°ä½æ„æˆå¨èƒã€‚åŒæ—¶ï¼Œå›¢é˜Ÿå†…éƒ¨å› å‘å±•æ–¹å‘ã€èµ„æºåˆ†é…æˆ–æ—©æœŸæˆå‘˜çš„â€œåˆå¿ƒâ€ä¸æ–°é˜¶æ®µå•†ä¸šç›®æ ‡çš„å†²çªï¼ˆå½“å‰ç‰¹æ®ŠçŠ¶æ€ï¼šâ€œ${gs.specialStatus.join(', ')}â€ï¼‰ï¼Œå‡ºç°â€œæˆé•¿çš„çƒ¦æ¼â€ï¼Œå†³ç­–æ•ˆç‡å’Œå‡èšåŠ›å—åˆ°æŒ‘æˆ˜ã€‚`,
                yearTriggerMin: 2028, yearTriggerMax: 2028, triggered: false,
                choices: [
                    {
                        text: "å¯¹å¤–åŠ é€Ÿåˆ›æ–°ï¼Œå¯¹å†…å¼ºåŒ–æ ¸å¿ƒé¢†å¯¼ä¸æˆ˜ç•¥ç»Ÿä¸€",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 25); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Significant investment
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 4); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.max(0, gs.teamEffectiveness - 20); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); // Major internal shake-up
                            oldVal = gs.contributorsCount; gs.contributorsCount = Math.max(5, gs.contributorsCount - 3); c.push(`è´¡çŒ®è€…æ•°é‡ ${oldVal} -> ${gs.contributorsCount}`);
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.max(0, gs.contributorMorale -2); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 20); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 10); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 8); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 12); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            gs.specialStatus = gs.specialStatus.filter(s => s.includes("æ¢ç´¢æœŸ") || s.includes("é‡å¡‘æœŸ") || s.includes("å°è¯•å¤±è´¥"));
                            if (!gs.specialStatus.includes("ç ´é‡œæ²‰èˆŸå¼é©æ–°")) gs.specialStatus.push("ç ´é‡œæ²‰èˆŸå¼é©æ–°");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šé«˜æŠ•å…¥çš„åˆ›æ–°å’Œå†…éƒ¨æ•´åˆè‹¥æˆåŠŸï¼Œèƒ½ç”©å¼€æ¨¡ä»¿è€…å¹¶ç»Ÿä¸€å›¢é˜Ÿæ„å¿—ï¼Œä½†çŸ­æœŸè´¢åŠ¡å’Œå›¢é˜Ÿé˜µç—›å‰§çƒˆï¼Œå¤±è´¥åˆ™å…ƒæ°”å¤§ä¼¤ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´æ ¸å¿ƒäººå‘˜æµå¤±ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿå†³å®šåŒç®¡é½ä¸‹ï¼Œç ´é‡œæ²‰èˆŸï¼šå¯¹å¤–ä¸æƒœè¡€æœ¬åŠ å¤§åˆ›æ–°æŠ•å…¥ä»¥ç”©å¼€æ¨¡ä»¿è€…ï¼Œå¯¹å†…åˆ™ç”±æ ¸å¿ƒé¢†å¯¼å±‚å¼ºåŠ›æ¨åŠ¨æˆ˜ç•¥ç»Ÿä¸€ä¸ç»„ç»‡è°ƒæ•´ï¼Œå³ä½¿è¿™æ„å‘³ç€ä¸€äº›å†…éƒ¨è°ƒæ•´ã€äººå‘˜ä¼˜åŒ–å’Œæƒ…æ„Ÿä¸Šçš„å·¨å¤§ä»£ä»·ã€‚è¿™æ˜¯ä¸€ä¸ªæå…¶ç—›è‹¦ä½†æ—¨åœ¨ç ´å±€çš„è½¬å‹æœŸã€‚"
                    },
                    {
                        text: "å¯¹å†…ä¼˜å…ˆå˜é©ï¼Œæš‚é¿å¤–éƒ¨ç«äº‰é”‹èŠ’ï¼Œå¯»æ±‚å·®å¼‚åŒ–",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 10); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Cost of internal consultants/workshops
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 20); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); // Significant internal gain
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.min(10, gs.contributorMorale + 2); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 10); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 2); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.max(0, gs.marketPosition - 12); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`); // Market share loss
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 12); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 18); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            gs.specialStatus = gs.specialStatus.filter(s => s.includes("æ¢ç´¢æœŸ") || s.includes("è½¬å‹æœŸ") || s.includes("å°è¯•å¤±è´¥"));
                            if (!gs.specialStatus.includes("å†…éƒ¨æ–‡åŒ–ä¸ç»“æ„ä¼˜åŒ–")) gs.specialStatus.push("å†…éƒ¨æ–‡åŒ–ä¸ç»“æ„ä¼˜åŒ–");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šå†…éƒ¨å˜é©æˆåŠŸå°†æå¤§æå‡å›¢é˜Ÿçš„é•¿æœŸæˆ˜æ–—åŠ›å’Œæ„¿æ™¯æ‰§è¡ŒåŠ›ï¼Œä¸ºåç»­çš„å¸‚åœºç«äº‰æ‰“ä¸‹åšå®åŸºç¡€ã€‚ä½†çŸ­æœŸå†…å¯èƒ½å› æˆ˜ç•¥ä¿å®ˆè€Œé”™å¤±ä¸€äº›å¸‚åœºæœºä¼šï¼Œå¸‚åœºåœ°ä½å’Œå“ç‰Œå£°èª‰æš‚æ—¶ä¸‹æ»‘ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿè®¤ä¸ºæ”˜å¤–å¿…å…ˆå®‰å†…ï¼Œå†³å®šä¼˜å…ˆæŠ•å…¥ç²¾åŠ›è¿›è¡Œå†…éƒ¨ç»„ç»‡å˜é©ã€æ˜æ™°æƒè´£åˆ©ã€é‡å¡‘å›¢é˜Ÿæ–‡åŒ–ä¸å†³ç­–æµç¨‹ï¼ŒåŒæ—¶åœ¨å¤–éƒ¨ç«äº‰ä¸­é‡‡å–å·®å¼‚åŒ–ç­–ç•¥ï¼Œæš‚é¿å¯¹æ‰‹é”‹èŠ’ã€‚å›¢é˜Ÿçš„å‡èšåŠ›å’Œæˆ˜ç•¥æ¸…æ™°åº¦å¾—åˆ°æ˜¾è‘—æå‡ã€‚"
                    },
                    {
                        text: "å¯»æ±‚ä¸å…³é”®æ¨¡ä»¿è€…/å¸‚åœºåŠ›é‡çš„åˆä½œæˆ–æ•´åˆ",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            if (Math.random() < 0.30) { // Reduced success rate
                                oldVal = gs.financialHealth; gs.financialHealth = Math.min(100, gs.financialHealth + 20); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Better gain
                                oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 8); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                                oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 10); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                                oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 25); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`); // Better gain
                                oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 18); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                                oldVal = gs.visionExecution; gs.visionExecution = Math.max(0, gs.visionExecution - 15); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`); // Greater compromise
                                if (!gs.specialStatus.includes("æˆ˜ç•¥åˆå¹¶/é‡è¦åˆä½œè¾¾æˆ")) gs.specialStatus.push("æˆ˜ç•¥åˆå¹¶/é‡è¦åˆä½œè¾¾æˆ");
                                gs.specialStatus = gs.specialStatus.filter(s => s.includes("æ¢ç´¢æœŸ") || s.includes("è½¬å‹æœŸ") || s.includes("é‡å¡‘æœŸ"));
                                return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šæˆåŠŸåˆä½œèƒ½å¿«é€Ÿæ‰©å¤§å¸‚åœºä»½é¢ï¼Œè§£å†³ç«äº‰å‹åŠ›ï¼Œä½†ä¹Ÿå¯èƒ½éœ€è¦åœ¨æ„¿æ™¯ã€äº§å“æ–¹å‘å’Œå›¢é˜Ÿæ–‡åŒ–ä¸Šåšå‡ºé‡å¤§å¦¥åï¼Œæ„¿æ™¯æ‰§è¡ŒåŠ›å—åˆ°è¾ƒå¤§å½±å“ã€‚`;
                            } else { 
                                oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.max(0, gs.teamEffectiveness - 15); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); // Bigger hit
                                oldVal = gs.marketPosition; gs.marketPosition = Math.max(0, gs.marketPosition - 10); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`); // Bigger hit
                                oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 8); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Cost of failed negotiation
                                oldVal = gs.brandReputation; gs.brandReputation = Math.max(0, gs.brandReputation - 10); c.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                                c.push("äº§å“ç«äº‰åŠ›æ— æ˜¾è‘—å˜åŒ–"); c.push("å•†ä¸šæ¨¡å¼å¯è¡Œæ€§æ— æ˜¾è‘—å˜åŒ–"); c.push("æ„¿æ™¯æ‰§è¡ŒåŠ›æ— æ˜¾è‘—å˜åŒ–");
                                if (!gs.specialStatus.includes("å¤–éƒ¨åˆä½œé‡å¤§æŒ«æŠ˜")) gs.specialStatus.push("å¤–éƒ¨åˆä½œé‡å¤§æŒ«æŠ˜");
                                return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šåˆä½œè°ˆåˆ¤å¤±è´¥ï¼Œä¸ä»…é”™å¤±æœºä¼šï¼Œæ¶ˆè€—äº†å›¢é˜Ÿç²¾åŠ›ä¸èµ„é‡‘ï¼Œè¿˜å¯èƒ½è®©ç«äº‰å¯¹æ‰‹æ›´åŠ è­¦æƒ•ï¼Œå†…éƒ¨å› æœªèƒ½è§£å†³é—®é¢˜è€Œå£«æ°”ä¸¥é‡å—æŒ«ï¼Œå“ç‰Œå£°èª‰å—æŸã€‚`;
                            }
                        },
                        feedback: "é¢å¯¹å¤æ‚çš„å†…å¤–éƒ¨å±€é¢ï¼Œå›¢é˜Ÿå¼€å§‹å°è¯•ä¸å¸‚åœºä¸Šçš„ä¸€äº›å…³é”®åŠ›é‡ï¼ˆç”šè‡³æ˜¯æ¨¡ä»¿è€…ï¼‰è¿›è¡Œæ¥è§¦ï¼Œå¯»æ±‚åˆä½œã€æ•´åˆç”šè‡³è¢«å¹¶è´­çš„å¯èƒ½æ€§ã€‚/ åˆä½œè°ˆåˆ¤æœ€ç»ˆç ´è£‚ï¼ŒTPGä¸ä»…æœªèƒ½è§£å†³å¤–éƒ¨ç«äº‰é—®é¢˜ï¼Œåè€Œå› æ­¤æ¶ˆè€—äº†ä¸å°‘ç²¾åŠ›ï¼Œå¹¶æš´éœ²äº†è‡ªèº«çš„å›°å¢ƒï¼Œå›¢é˜Ÿå£«æ°”ä½è½ã€‚"
                    }
                ]
            },
            { // Event 5 - 2029
                id: "TPG_SIM_2029_COMMERCIAL_COMMUNITY_BALANCE",
                title: "2029ï¼šä»·å€¼çš„æƒè¡¡ - å•†ä¸šåŒ–æ·±åŒ–ä¸ç¤¾ç¾¤åˆå¿ƒ",
                description: (gs) => `TPGçš„å•†ä¸šåŒ–å·²å–å¾—ä¸€å®šè¿›å±•ï¼ˆå¦‚B2Bå®šåˆ¶ä¸šåŠ¡ç¨³å®šï¼‰ï¼Œä½†å›¢é˜Ÿå‘ç°ï¼Œè¿‡åº¦è¿½æ±‚è¥æ”¶å¢é•¿å¯èƒ½å¼€å§‹ä¾µèš€ç¤¾ç¾¤çš„å…±åˆ›æ°›å›´å’Œç”¨æˆ·ä¿¡ä»»ã€‚æ ¸å¿ƒç”¨æˆ·ï¼ˆç¤¾ç¾¤è§„æ¨¡çº¦${gs.communitySize}äººï¼Œæ´»è·ƒåº¦${gs.communityEngagement}%ï¼‰å¯¹å¹³å°çš„â€œåŠŸåˆ©åŒ–â€å€¾å‘è¡¨ç¤ºæ‹…å¿§ï¼Œéƒ¨åˆ†æ ¸å¿ƒè´¡çŒ®è€…ï¼ˆå½“å‰çº¦${gs.contributorsCount}åï¼Œå£«æ°”${gs.contributorMorale}/10ï¼‰çš„â€œç¤¾åŒºé¡¹ç›®â€ææ¡ˆçƒ­æƒ…ä¸‹é™ï¼Œç§¯åˆ†ä½“ç³»å¥åº·åº¦ï¼ˆå½“å‰çŠ¶æ€ï¼š${gs.pointsSystemStatus}ï¼‰é¢ä¸´è€ƒéªŒã€‚`,
                yearTriggerMin: 2029, yearTriggerMax: 2029, triggered: false,
                choices: [
                    {
                        text: "ç»§ç»­æ·±åŒ–å•†ä¸šåŒ–ï¼Œä¼˜å…ˆè´¢åŠ¡å›æŠ¥",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.min(100, gs.financialHealth + 30); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`);
                            oldVal = gs.monthlyBurnRate; gs.monthlyBurnRate -= 1500; c.push(`æœˆåº¦è¿è¥æˆæœ¬ ${oldVal} -> ${gs.monthlyBurnRate}`);
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.max(0, gs.teamEffectiveness - 20); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.max(0, gs.contributorMorale - 4); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.communityEngagement; gs.communityEngagement = Math.max(0, gs.communityEngagement - 25); c.push(`ç¤¾ç¾¤æ´»è·ƒåº¦ ${oldVal}% -> ${gs.communityEngagement}%`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 10); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.max(0, gs.brandReputation - 20); c.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 25); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.max(0, gs.visionExecution - 25); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if(!gs.specialStatus.includes("è¥æ”¶é©±åŠ¨æˆ˜ç•¥")) gs.specialStatus.push("è¥æ”¶é©±åŠ¨æˆ˜ç•¥");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "ç¤¾ç¾¤ä»·å€¼å›å½’");
                            gs.pointsSystemStatus = "å•†ä¸šåŒ–ä¾µèš€ä¸­"; c.push(`ç§¯åˆ†ä½“ç³»çŠ¶æ€ -> ${gs.pointsSystemStatus}`);
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šè´¢åŠ¡çŠ¶å†µå’Œç›ˆåˆ©èƒ½åŠ›æ˜¾è‘—æ”¹å–„ã€‚ä½†ç¤¾ç¾¤æ´»è·ƒåº¦å’Œè´¡çŒ®è€…å£«æ°”å¤§å¹…ä¸‹é™ï¼Œå“ç‰Œå£°èª‰å› â€œåŠŸåˆ©åŒ–â€å—æŸï¼Œå›¢é˜Ÿå†…éƒ¨å¯¹ä¸¥é‡åç¦»â€œæ¸¸ç‰§ç½‘ç»œâ€å’Œâ€œç²¾ç¥å¤§å­¦â€æ„¿æ™¯çš„æ‹…å¿§åŠ å‰§ï¼Œæ ¸å¿ƒå›¢é˜Ÿå‡èšåŠ›ä¸‹é™ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿå†³å®šå°†è´¢åŠ¡å›æŠ¥ç½®äºç»å¯¹ä¼˜å…ˆåœ°ä½ï¼ŒåŠ é€Ÿå•†ä¸šåŒ–è¿›ç¨‹ã€‚è¥æ”¶æ•°æ®é£™å‡ï¼Œä½†ä¹Ÿæ¸…æ™°åœ°å¬åˆ°äº†æ¥è‡ªç¤¾ç¾¤æ·±å¤„å¤±è½çš„å¹æ¯ï¼ŒTPGçš„â€œåˆå¿ƒâ€æ­£åœ¨ç»å—ä¸¥å³»è€ƒéªŒï¼Œä¸€äº›æ—©æœŸæˆå‘˜å¼€å§‹æ„Ÿåˆ°è¿·èŒ«ã€‚"
                    },
                    {
                        text: "è°ƒæ•´å•†ä¸šç­–ç•¥ï¼Œå¼•å…¥ç¤¾ç¾¤å…±èµ¢æœºåˆ¶",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.min(100, gs.financialHealth + 10); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`);
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 20); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.min(10, gs.contributorMorale + 4); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.communityEngagement; gs.communityEngagement = Math.min(100, gs.communityEngagement + 30); c.push(`ç¤¾ç¾¤æ´»è·ƒåº¦ ${oldVal}% -> ${gs.communityEngagement}%`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 12); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 15); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.min(100, gs.brandReputation + 25); c.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.communitySize; gs.communitySize += Math.floor(gs.communitySize * 0.15); c.push(`ç¤¾ç¾¤è§„æ¨¡ ${oldVal} -> ${gs.communitySize}`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 18); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            gs.pointsSystemStatus = "ç¤¾ç¾¤å…±èµ¢V2.0æ¿€æ´»"; c.push(`ç§¯åˆ†ä½“ç³»çŠ¶æ€ -> ${gs.pointsSystemStatus}`);
                            oldVal = gs.communityPointsPool; gs.communityPointsPool += 1200; c.push(`ç¤¾åŒºç§¯åˆ†æ±  ${oldVal} -> ${gs.communityPointsPool}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 25); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if(!gs.specialStatus.includes("ç¤¾ç¾¤ä»·å€¼å›å½’")) gs.specialStatus.push("ç¤¾ç¾¤ä»·å€¼å›å½’");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "è¥æ”¶é©±åŠ¨æˆ˜ç•¥");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šçŸ­æœŸç›ˆåˆ©å¢é€Ÿæ”¾ç¼“ï¼Œä½†ç¤¾ç¾¤ä¿¡ä»»æ˜¾è‘—ä¿®å¤ï¼Œè´¡çŒ®è€…ç§¯ææ€§å’Œé«˜è´¨é‡UGCäº§å‡ºå¤§å¹…æå‡ï¼Œå“ç‰Œå£ç¢‘å’Œå¸‚åœºåœ°ä½å¾—åˆ°å·©å›ºå’Œæå‡ï¼Œå•†ä¸šæ¨¡å¼æ›´å…·é•¿æœŸå¯æŒç»­æ€§ï¼Œæ›´å¥‘åˆâ€œç²¾ç¥å¤§å­¦â€å’Œâ€œæ¸¸ç‰§ç½‘ç»œâ€çš„æ„¿æ™¯ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿæ·±åˆ»åæ€åï¼Œå†³å®šè°ƒæ•´å•†ä¸šåŒ–ç­–ç•¥ï¼Œå¼•å…¥æ›´é€æ˜çš„æ”¶ç›Šåˆ†äº«æœºåˆ¶å’Œç¤¾ç¾¤æ²»ç†ç»“æ„ï¼Œå°†éƒ¨åˆ†å•†ä¸šæ”¶ç›Šï¼ˆä¾‹å¦‚é€šè¿‡å£®å¤§å…¬å…±åŸºé‡‘å’Œä¼˜åŒ–ç§¯åˆ†å…‘æ¢ï¼‰åå“ºç¤¾ç¾¤å»ºè®¾å’Œæ ¸å¿ƒè´¡çŒ®è€…æ¿€åŠ±ã€‚è¿™ä¸€ä¸¾æªé‡æ–°ç‚¹ç‡ƒäº†ç¤¾ç¾¤çš„ä¿¡ä»»ä¸å…±åˆ›çƒ­æƒ…ï¼ŒTPGçš„ç¤¾ç¾¤ç”Ÿæ€ç„•å‘å‡ºæ–°çš„æ´»åŠ›ã€‚"
                    },
                    {
                        text: "ä¿æŒç°çŠ¶ï¼Œè°¨æ…è§‚å¯Ÿï¼Œæš‚ä¸è°ƒæ•´",
                        effects: (gs) => {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.min(100, gs.financialHealth + 8); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); 
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.max(0, gs.teamEffectiveness - 12); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`);
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.max(0, gs.contributorMorale - 3); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.communityEngagement; gs.communityEngagement = Math.max(0, gs.communityEngagement - 15); c.push(`ç¤¾ç¾¤æ´»è·ƒåº¦ ${oldVal}% -> ${gs.communityEngagement}%`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.max(0, gs.marketPosition - 10); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`);
                            oldVal = gs.brandReputation; gs.brandReputation = Math.max(0, gs.brandReputation - 12); c.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.max(0, gs.visionExecution - 12); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`);
                            if (!gs.specialStatus.includes("ç¤¾ç¾¤çŸ›ç›¾åŠ å‰§")) gs.specialStatus.push("ç¤¾ç¾¤çŸ›ç›¾åŠ å‰§");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šçŸ­æœŸå†…é¿å…äº†è°ƒæ•´å¸¦æ¥çš„é˜µç—›ï¼Œä½†ç¤¾ç¾¤å†…éƒ¨çš„è´Ÿé¢æƒ…ç»ªå’Œä¿¡ä»»å±æœºæŒç»­å‘é…µå¹¶åŠ å‰§ï¼Œæ ¸å¿ƒè´¡çŒ®è€…æµå¤±é£é™©å¢å¤§ï¼Œå£ç¢‘å’Œå¸‚åœºåœ°ä½å—åˆ°ä¾µèš€ï¼Œå›¢é˜Ÿæ•ˆèƒ½æŒç»­ä¸‹æ»‘ï¼Œä¸æ„¿æ™¯çš„åç¦»è¶Šæ¥è¶Šå¤§ã€‚`;
                        },
                        feedback: "å›¢é˜Ÿå¯¹æ˜¯å¦è°ƒæ•´å•†ä¸šç­–ç•¥çŠ¹è±«ä¸å†³ï¼Œé€‰æ‹©æš‚æ—¶ç»´æŒç°çŠ¶ï¼Œå¸Œæœ›é—®é¢˜èƒ½è‡ªè¡Œç¼“è§£ã€‚ç„¶è€Œï¼Œç¤¾ç¾¤çš„è€å¿ƒä¼¼ä¹æ­£åœ¨è€—å°½ï¼Œä¸æ»¡çš„å£°éŸ³è¶Šæ¥è¶Šå¤§ï¼ŒTPGçš„å“ç‰Œå£°èª‰å¼€å§‹å—åˆ°å®è´¨æ€§å½±å“ï¼Œä¸€äº›æ ¸å¿ƒç”¨æˆ·å’Œè´¡çŒ®è€…é€‰æ‹©ç¦»å¼€ã€‚"
                    }
                ]
            },
            { // Event 6 - 2030
                id: "TPG_SIM_2030_AGI_REVOLUTION",
                title: "2030ï¼šæ—¶ä»£çš„ç»ˆæè¯•ç‚¼ - AGIæµªæ½®ä¸‹çš„é¢ è¦†ä¸é‡å¡‘",
                description: "é€šç”¨äººå·¥æ™ºèƒ½(AGI)æŠ€æœ¯åœ¨2030å¹´å–å¾—é¢ è¦†æ€§çªç ´ï¼Œå¼€å§‹æ·±åº¦é‡å¡‘å†…å®¹åˆ›ä½œã€ç¤¾ç¾¤äº’åŠ¨ã€ä¹ƒè‡³å•†ä¸šæ¨¡å¼çš„æ–¹æ–¹é¢é¢ã€‚ç”¨æˆ·å¯¹AIæ·±åº¦æ•´åˆçš„ä½“éªŒæŠ±æœ‰æé«˜æœŸå¾…ã€‚TPGçš„æ ¸å¿ƒä»·å€¼ï¼ˆäººç±»åä½œå™äº‹ã€æ·±åº¦æ€è¾¨å¼•å¯¼ï¼‰å—åˆ°äº†å‰æ‰€æœªæœ‰çš„æŒ‘æˆ˜ã€‚å›¢é˜Ÿå¿…é¡»åšå‡ºå…³ä¹TPGæœªæ¥å½¢æ€å’Œç”Ÿå­˜æ–¹å¼çš„æ ¹æœ¬æ€§æŠ‰æ‹©ã€‚è¿™æ˜¯å†³å®šTPGèƒ½å¦è¿›åŒ–ä»¥é€‚åº”æ–°æ—¶ä»£çš„å…³é”®æ—¶åˆ»ã€‚",
                yearTriggerMin: 2030, yearTriggerMax: 2030, triggered: false,
                choices: [
                    {
                        text: "å…¨é¢æ‹¥æŠ±AGIï¼šæˆä¸ºAIé©±åŠ¨çš„åä½œæ™ºèƒ½å¹³å°",
                        effects: function(gs) {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 40); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Massive cost
                            oldVal = gs.monthlyBurnRate; gs.monthlyBurnRate += 10000; c.push(`æœˆåº¦è¿è¥æˆæœ¬ ${oldVal} -> ${gs.monthlyBurnRate}`);
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.max(0, gs.teamEffectiveness - 35); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); // Massive disruption
                            oldVal = gs.contributorsCount; gs.contributorsCount = Math.max(2, Math.floor(gs.contributorsCount * 0.4)); c.push(`è´¡çŒ®è€…æ•°é‡ ${oldVal} -> ${gs.contributorsCount}`);
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.max(0, gs.contributorMorale - 5); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 50); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`); // High potential if successful
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, 10); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`); // Max out if successful
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 45); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`); 
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 35); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.max(0, gs.visionExecution - 50); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`); // Massive deviation from original human-centric vision
                            gs.specialStatus = ["AGIå¹³å°é©å‘½æ€§è½¬å‹", "ç»„ç»‡ç»“æ„å‰§å˜", "é«˜é£é™©é«˜å›æŠ¥æ¢ç´¢æœŸ", "çƒ§é’±ç»­å‘½"];
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "åšå®ˆäººæ–‡æ ¸å¿ƒ" && s !== "æ·±è€•äººæ–‡ä½“éªŒç»†åˆ†å¸‚åœº"  && s !== "äººæœºå…±ç”Ÿæ¨¡å¼æ¢ç´¢ä¸­");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šä¸€åœºå½»åº•çš„è±ªèµŒã€‚è‹¥è½¬å‹æˆåŠŸï¼ŒTPGå¯èƒ½æˆä¸ºæ–°æ—¶ä»£çš„é¢†å¯¼è€…ï¼›ä½†è½¬å‹é£é™©æé«˜ï¼Œè´¢åŠ¡ã€å›¢é˜Ÿé¢ä¸´å·¨å¤§å‹åŠ›ï¼Œä¸€æ—¦å¤±è´¥ï¼Œå‰æœŸæ‰€æœ‰ç§¯ç´¯å¯èƒ½ä»˜è¯¸ä¸œæµï¼Œç›´æ¥å¯¼è‡´æ¸¸æˆç»“æŸã€‚äººæ–‡æ„¿æ™¯å‡ ä¹è¢«æŠ€æœ¯æ„¿æ™¯å–ä»£ï¼Œä¸â€œç²¾ç¥å¤§å­¦â€ç†å¿µæ¸è¡Œæ¸è¿œã€‚`;
                        },
                        feedback: "TPGå†³å®šä»¥å£®å£«æ–­è…•çš„å†³å¿ƒï¼Œå…¨é¢æ‹¥æŠ±AGIï¼Œç›®æ ‡æ˜¯æˆä¸ºä¸‹ä¸€ä»£AIé©±åŠ¨çš„åä½œæ™ºèƒ½å¹³å°çš„å®šä¹‰è€…ï¼è¿™æ˜¯ä¸€åœºä¹æ­»ä¸€ç”Ÿçš„è±ªèµŒï¼Œå›¢é˜Ÿå¼€å§‹äº†ç—›è‹¦è€Œå‰§çƒˆçš„æŠ€æœ¯æ”»åšã€æŠ€èƒ½è¿­ä»£å’Œæ¨¡å¼é‡å¡‘ï¼Œæ—§çš„TPGå‡ ä¹ä¸å¤å­˜åœ¨ï¼Œè´¢åŠ¡å‹åŠ›ç©ºå‰å·¨å¤§ã€‚"
                    },
                    {
                        text: "äººæœºå…±ç”Ÿï¼šå°†AGIä½œä¸ºèµ‹èƒ½å·¥å…·ï¼Œåšå®ˆäººæ–‡æ ¸å¿ƒ",
                        effects: function(gs) {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.max(0, gs.financialHealth - 18); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Significant but managed cost
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 15); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); 
                            oldVal = gs.contributorMorale; gs.contributorMorale = Math.min(10, gs.contributorMorale + 3); c.push(`è´¡çŒ®è€…å£«æ°” ${oldVal} -> ${gs.contributorMorale}`);
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 30); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`); 
                            oldVal = gs.productInnovation; gs.productInnovation = Math.min(10, gs.productInnovation + 4); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`);
                            oldVal = gs.marketPosition; gs.marketPosition = Math.min(100, gs.marketPosition + 25); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`); 
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 20); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`);
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 30); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`); // Vision evolved
                            if(!gs.specialStatus.includes("äººæœºå…±ç”Ÿåˆ›æ–°å¼•é¢†è€…")) gs.specialStatus.push("äººæœºå…±ç”Ÿåˆ›æ–°å¼•é¢†è€…");
                            if(!gs.specialStatus.includes("äººæ–‡ä»·å€¼ä¸ç§‘æŠ€æ·±åº¦èåˆ")) gs.specialStatus.push("äººæ–‡ä»·å€¼ä¸ç§‘æŠ€æ·±åº¦èåˆ");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "å…¨é¢AGIåŒ–è½¬å‹ä¸­" && s !== "æ·±è€•äººæ–‡ä½“éªŒç»†åˆ†å¸‚åœº");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šæˆåŠŸåœ°å°†AGIèå…¥ç°æœ‰æ ¸å¿ƒä»·å€¼ï¼Œæå¤§æå‡äº†äº§å“ä½“éªŒçš„æ·±åº¦ã€ä¸ªæ€§åŒ–å’Œè¿è¥æ•ˆç‡ï¼Œå½¢æˆäº†ç‹¬ç‰¹çš„å¸‚åœºç«äº‰åŠ›ã€‚å›¢é˜ŸæŠ€èƒ½å¾—åˆ°æå‡ï¼Œæ„¿æ™¯åœ¨ç§‘æŠ€æµªæ½®ä¸­å¾—åˆ°å‡åå’Œå»¶ç»­ï¼Œæ›´å¥½åœ°æœåŠ¡â€œæ¸¸ç‰§ç½‘ç»œâ€å’Œâ€œç²¾ç¥å¤§å­¦â€çš„ç†å¿µã€‚`;
                        },
                        feedback: "TPGé€‰æ‹©äº†ä¸€æ¡äººæœºå…±ç”Ÿçš„è¿›åŒ–ä¹‹è·¯ï¼å›¢é˜Ÿå¼€å§‹ç§¯ææ¢ç´¢å¦‚ä½•è®©AGIæˆä¸ºå¢å¼ºäººç±»åä½œå™äº‹å’Œæ·±åº¦æ€è¾¨çš„å¼ºå¤§å·¥å…·ï¼Œè€Œéæ›¿ä»£å“ã€‚è¿™æ—¢æ˜¯å¯¹å‰æ²¿æŠ€æœ¯çš„æ‹¥æŠ±ï¼Œä¹Ÿæ˜¯å¯¹äººæ–‡æ ¸å¿ƒä»·å€¼çš„åšå®ˆä¸åˆ›æ–°æ€§å‘å±•ï¼Œå›¢é˜Ÿä¸ºæ­¤å……æ»¡å¹²åŠ²ã€‚"
                    },
                    {
                        text: "æ•°å­—æ¡ƒèŠ±æºï¼šä¸“æ³¨æœåŠ¡æ ¸å¿ƒå°ä¼—ï¼Œå¼ºåŒ–çº¯ç²¹äººæ–‡ä½“éªŒ",
                        effects: function(gs) {
                            let c = []; let oldVal;
                            oldVal = gs.financialHealth; gs.financialHealth = Math.min(100, gs.financialHealth + 10); c.push(`è´¢åŠ¡çŠ¶å†µ ${oldVal} -> ${gs.financialHealth}`); // Niche profit, less reliant on scale
                            oldVal = gs.teamEffectiveness; gs.teamEffectiveness = Math.min(100, gs.teamEffectiveness + 15); c.push(`å›¢é˜Ÿæ•ˆèƒ½ ${oldVal} -> ${gs.teamEffectiveness}`); 
                            oldVal = gs.productStrength; gs.productStrength = Math.min(100, gs.productStrength + 18); c.push(`äº§å“ç«äº‰åŠ› ${oldVal} -> ${gs.productStrength}`);
                            oldVal = gs.productInnovation; gs.productInnovation = Math.max(0, gs.productInnovation - 1); c.push(`äº§å“åˆ›æ–°åŠ› ${oldVal} -> ${gs.productInnovation}`); // Less tech innovation focus
                            oldVal = gs.marketPosition; gs.marketPosition = Math.max(0, gs.marketPosition - 30); c.push(`å¸‚åœºåœ°ä½ ${oldVal} -> ${gs.marketPosition}`); // Significant mass market loss
                            oldVal = gs.brandReputation; gs.brandReputation = Math.min(100, gs.brandReputation + 30); c.push(`å“ç‰Œå£°èª‰ ${oldVal} -> ${gs.brandReputation}`);
                            oldVal = gs.communitySize; gs.communitySize = Math.max(200, Math.floor(gs.communitySize * 0.5)); c.push(`ç¤¾ç¾¤è§„æ¨¡ ${oldVal} -> ${gs.communitySize}`); // Smaller, highly dedicated
                            oldVal = gs.communityEngagement; gs.communityEngagement = Math.min(100, gs.communityEngagement + 20); c.push(`ç¤¾ç¾¤æ´»è·ƒåº¦ ${oldVal}% -> ${gs.communityEngagement}%`);
                            oldVal = gs.businessViability; gs.businessViability = Math.min(100, gs.businessViability + 10); c.push(`å•†ä¸šæ¨¡å¼å¯è¡Œæ€§ ${oldVal} -> ${gs.businessViability}`); 
                            oldVal = gs.visionExecution; gs.visionExecution = Math.min(100, gs.visionExecution + 35); c.push(`æ„¿æ™¯æ‰§è¡ŒåŠ› ${oldVal} -> ${gs.visionExecution}`); // Ultimate vision adherence
                            if(!gs.specialStatus.includes("çº¯ç²¹äººæ–‡ä½“éªŒå®ˆæŠ¤è€…")) gs.specialStatus.push("çº¯ç²¹äººæ–‡ä½“éªŒå®ˆæŠ¤è€…");
                            if(!gs.specialStatus.includes("åç’å½’çœŸæˆ˜ç•¥")) gs.specialStatus.push("åç’å½’çœŸæˆ˜ç•¥");
                            gs.specialStatus = gs.specialStatus.filter(s => s !== "å…¨é¢AGIåŒ–è½¬å‹ä¸­" && s !== "äººæœºå…±ç”Ÿæ¨¡å¼æ¢ç´¢ä¸­");
                            return `å±æ€§å˜åŒ–ï¼š${c.join('ï¼›')}ã€‚è¿é”ååº”ï¼šè™½ç„¶å½»åº•æ”¾å¼ƒäº†è¿½é€ä¸»æµå¸‚åœºå’Œå‰æ²¿æŠ€æœ¯ï¼Œå•†ä¸šè§„æ¨¡å—é™ï¼Œä½†é€šè¿‡æä¾›æè‡´ä¸”çº¯ç²¹çš„äººæ–‡ä½“éªŒï¼Œåœ¨ç‰¹å®šå°ä¼—å¸‚åœºå»ºç«‹æé«˜çš„ç”¨æˆ·å¿ è¯šåº¦å’Œå“ç‰Œç¾èª‰åº¦ï¼Œå½¢æˆç‹¬ç‰¹çš„æ–‡åŒ–â€œæŠ¤åŸæ²³â€ã€‚ç„¶è€Œï¼Œå¦‚æœå°ä¼—å¸‚åœºè¿›ä¸€æ­¥èç¼©æˆ–ç”Ÿæ´»æ–¹å¼è¢«AGIé—´æ¥é¢ è¦†ï¼Œæ­¤è·¯å¾„ä¹Ÿé¢ä¸´ç”Ÿå­˜é£é™©ã€‚`;
                        },
                        feedback: "é¢å¯¹AGIçš„é¢ è¦†æ€§å˜é©ï¼ŒTPGæ¯…ç„¶é€‰æ‹©å›å½’å…¶æœ€æ ¸å¿ƒçš„äººæ–‡ä»·å€¼ï¼ŒæœåŠ¡å¥½çœŸæ­£çƒ­çˆ±æ·±åº¦ã€çº¯ç²¹ã€æ— AIå¹²æ‰°ä½“éªŒçš„å°ä¼—ç¤¾ç¾¤ï¼ŒåŠªåŠ›æˆä¸ºæ±¹æ¶Œç§‘æŠ€æ—¶ä»£ä¸­çš„ä¸€æ–¹â€œæ•°å­—æ¡ƒèŠ±æºâ€ã€‚è¿™æˆ–è®¸æ„å‘³ç€æ”¾å¼ƒäº†æ˜Ÿè¾°å¤§æµ·ï¼Œä½†å¯èƒ½æ”¶è·ä¸€ç‰‡å®é™ä¸”å¿ è¯šçš„ã€çœŸæ­£è·µè¡Œâ€œç²¾ç¥å¤§å­¦â€ç†å¿µçš„æ¸¯æ¹¾ã€‚"
                    }
                ]
            }
        ];

        // --- UI Definitions for Status Dashboard ---
        const statusUIDefinitions = [
            { 
                id: "financialHealth", 
                title: "è´¢åŠ¡çŠ¶å†µ", 
                iconSVG: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 7h2v2h-2V7zm0 4h2v6h-2v-6z"/></svg>`,
                tooltipText: "å›¢é˜Ÿçš„èµ„é‡‘å‚¨å¤‡ã€ç°é‡‘æµå¥åº·åº¦åŠç›ˆåˆ©èƒ½åŠ›ã€‚è¯„åˆ†ä½äºç­‰äº10åˆ™æ¿’ä¸´ç ´äº§ã€‚",
                valueKey: "financialHealth",
                descGetterKey: "getFinancialHealthDescription",
                colorLogicFn: (gs) => {
                    const score = gs.financialHealth;
                    if (score <= 10) return '#e74c3c'; 
                    if (score < 20) return '#f39c12'; 
                    if (score < 50) return '#f1c40f'; 
                    return '#2ecc71'; 
                }
            },
            { 
                id: "teamEffectiveness", 
                title: "å›¢é˜Ÿæ•ˆèƒ½", 
                iconSVG: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>`,
                tooltipText: "æ ¸å¿ƒå›¢é˜Ÿå£«æ°”ã€å‡èšåŠ›ã€å…¼èŒè´¡çŒ®è€…çŠ¶æ€åŠæ•´ä½“åä½œæ•ˆç‡ã€‚è¯„åˆ†ä½äºç­‰äº20åˆ™æ¿’ä¸´è§£ä½“ã€‚",
                valueKey: "teamEffectiveness",
                descGetterKey: "getTeamEffectivenessDescription",
                colorLogicFn: (gs) => {
                    const score = gs.teamEffectiveness;
                    if (score <= 20) return '#e74c3c'; 
                    if (score < 45) return '#f39c12'; 
                    if (score < 75) return '#3498db'; 
                    return '#2ecc71'; 
                }
            },
            { 
                id: "productStrength", 
                title: "äº§å“ç«äº‰åŠ›", 
                iconSVG: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.08.5-.82C8.48 7.01 10.15 6 12 6c2.61 0 4.83 1.85 5.45 4.43l.3 1.18 1.17.07C20.21 11.79 21 12.8 21 14c0 1.65-1.35 3-3 3zM8 12h8v2H8v-2z"/></svg>`,
                tooltipText: "æ ¸å¿ƒäº§å“ï¼ˆè§„åˆ™/ä½“éªŒ/å†…å®¹ï¼‰çš„æˆç†Ÿåº¦ã€ç‹¬ç‰¹æ€§ä¸åˆ›æ–°åŠ›ã€‚",
                valueKey: "productStrength",
                descGetterKey: "getProductStrengthDescription",
                colorLogicFn: (gs) => {
                    const score = gs.productStrength;
                    if (score < 25) return '#e74c3c';
                    if (score < 45) return '#f39c12';
                    if (score < 75) return '#3498db';
                    return '#2ecc71';
                }
            },
            { 
                id: "marketPosition", 
                title: "å¸‚åœºåœ°ä½", 
                iconSVG: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`,
                tooltipText: "å¸‚åœºå½±å“åŠ›ã€å“ç‰Œå£°èª‰ã€ç”¨æˆ·/ç¤¾ç¾¤è§„æ¨¡ä¸æ´»è·ƒåº¦ã€ç«äº‰ä¼˜åŠ¿ã€‚",
                valueKey: "marketPosition",
                descGetterKey: "getMarketPositionDescription",
                colorLogicFn: (gs) => {
                    const score = gs.marketPosition;
                    if (score < 20) return '#e74c3c';
                    if (score < 40) return '#f39c12';
                    if (score < 70) return '#3498db';
                    return '#2ecc71';
                }
            },
            { 
                id: "businessViability", 
                title: "å•†ä¸šæ¨¡å¼å¯è¡Œæ€§", 
                iconSVG: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41s-.23-1.06-.59-1.42zM13 20.01L4 11V4h7v-.01l9 9-7 7.02z"/><circle cx="6.5" cy="6.5" r="1.5"/></svg>`,
                tooltipText: "ç›ˆåˆ©æ¨¡å¼æ¸…æ™°åº¦ä¸å¯æŒç»­æ€§ã€è¥æ”¶èƒ½åŠ›ã€ç¤¾åŒºç§¯åˆ†/å…¬å…±åŸºé‡‘å¥åº·åº¦ã€‚",
                valueKey: "businessViability",
                descGetterKey: "getBusinessViabilityDescription",
                colorLogicFn: (gs) => {
                    const score = gs.businessViability;
                    if (score < 20) return '#e74c3c';
                    if (score < 40) return '#f39c12';
                    if (score < 70) return '#3498db';
                    return '#2ecc71';
                }
            },
            { 
                id: "visionExecution", 
                title: "æ„¿æ™¯æ‰§è¡ŒåŠ›", 
                iconSVG: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C20.73 7.61 17 4.5 12 4.5zm0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>`,
                tooltipText: "å½“å‰æˆ˜ç•¥ä¸åˆæ­¥æ„¿æ™¯ï¼ˆâ€œæ¸¸ç‰§ç½‘ç»œâ€ã€â€œç²¾ç¥å¤§å­¦â€ï¼‰çš„å¥‘åˆåº¦ï¼Œå›¢é˜Ÿç‰¹æ®ŠçŠ¶æ€ï¼Œå…³é”®é‡Œç¨‹ç¢‘ã€‚",
                valueKey: "visionExecution",
                descGetterKey: "getVisionExecutionDescription",
                colorLogicFn: (gs) => {
                    const score = gs.visionExecution;
                    if (score < 25) return '#e74c3c';
                    if (score < 45) return '#f39c12';
                    if (score < 75) return '#3498db';
                    return '#2ecc71';
                }
            }
        ];


        // --- DOM Elements ---
        let currentYearDisplay, phaseDisplay, statusDashboard, eventTitle, eventDescription, choicesContainer, feedbackText, nextButton, restartButton, gameLogUl, gameOverMessageEl, themeToggleButton;

        // --- Utility function to add or remove special status ensuring no duplicates ---
        function manageSpecialStatus(gs, statusToAdd, statusToRemove) {
            if (statusToRemove) {
                gs.specialStatus = gs.specialStatus.filter(s => !statusToRemove.includes(s));
            }
            if (statusToAdd) {
                statusToAdd.forEach(newStatus => {
                    if (!gs.specialStatus.includes(newStatus)) {
                        gs.specialStatus.push(newStatus);
                    }
                });
            }
        }


        // --- Core Game Functions ---
        window.addEventListener('DOMContentLoaded', () => {
            currentYearDisplay = document.getElementById('currentYearDisplay');
            phaseDisplay = document.getElementById('phaseDisplay');
            statusDashboard = document.getElementById('statusDashboard');
            eventTitle = document.getElementById('eventTitle');
            eventDescription = document.getElementById('eventDescription');
            choicesContainer = document.getElementById('choicesContainer');
            feedbackText = document.getElementById('feedbackText');
            nextButton = document.getElementById('nextButton');
            restartButton = document.getElementById('restartButton');
            gameLogUl = document.getElementById('gameLogUl');
            gameOverMessageEl = document.getElementById('gameOverMessage');
            themeToggleButton = document.getElementById('themeToggle');

            statusUIDefinitions.forEach(def => {
                const card = document.createElement('div');
                card.classList.add('status-card');
                card.id = `status-${def.id}`;
                const titleEl = document.createElement('h3');
                titleEl.innerHTML = `${def.iconSVG || ''} ${def.title}`;
                const tooltipSpan = document.createElement('span');
                tooltipSpan.classList.add('tooltip');
                tooltipSpan.textContent = 'â„¹ï¸';
                const tooltipTextSpan = document.createElement('span');
                tooltipTextSpan.classList.add('tooltiptext');
                tooltipTextSpan.textContent = def.tooltipText;
                tooltipSpan.appendChild(tooltipTextSpan);
                titleEl.appendChild(tooltipSpan);
                const valueDisplay = document.createElement('div');
                valueDisplay.classList.add('value');
                valueDisplay.id = `value-${def.id}`;
                const descDisplay = document.createElement('div');
                descDisplay.classList.add('description');
                descDisplay.id = `desc-${def.id}`;
                const progressBar = document.createElement('progress');
                progressBar.id = `progress-${def.id}`;
                progressBar.max = 100;
                progressBar.value = gameState[def.valueKey];
                card.appendChild(titleEl);
                card.appendChild(valueDisplay);
                card.appendChild(descDisplay);
                card.appendChild(progressBar);
                statusDashboard.appendChild(card);
            });
            
            if (localStorage.getItem('tpgSimTheme') === 'dark-mode') {
                document.body.classList.add('dark-mode');
            }
            themeToggleButton.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('tpgSimTheme', document.body.classList.contains('dark-mode') ? 'dark-mode' : 'light-mode');
            });

            nextButton.addEventListener('click', () => {
                if (gameState.turn === 0 && nextButton.textContent.includes("å¼€å§‹è¿œå¾")) {
                    addLogEntry("è¿œå¾å¼€å§‹ï¼", "year");
                    loadNextEvent(); 
                    nextButton.disabled = true; 
                } else {
                    advanceYearAndLoadEvent();
                }
            });
            restartButton.addEventListener('click', initializeGame);
            initializeGame();
        });

        function initializeGame() {
            gameState = JSON.parse(JSON.stringify(initialGameState));
            if(gameLogUl) gameLogUl.innerHTML = '';
            gameState.gameLog = [];
            eventLibrary.forEach(event => event.triggered = false);
            gameState.gameOver = false;
            gameState.gameOverReason = "";
            gameState.currentEvent = null;
            updateDashboard();
            if(eventTitle) eventTitle.textContent = "æ¬¢è¿æ¥åˆ°ã€Šåäººå°ç»„ - æœªæ¥è¿œå¾æ¨¡æ‹Ÿã€‹";
            if(eventDescription) eventDescription.innerHTML = `æ‚¨å’Œæ‚¨çš„å›¢é˜Ÿå°†å…±åŒå¯¼èˆªã€Šåäººå°ç»„ã€‹(TPG)é¡¹ç›®ä»2025å¹´è‡³2030å¹´çš„å‘å±•é“è·¯ã€‚<br>æ¯ä¸ªâ€œå›åˆâ€ä»£è¡¨ä¸€ä¸ªå…³é”®çš„å‘å±•é˜¶æ®µæˆ–å¹´ä»½ï¼Œæ‚¨å°†é¢ä¸´ä¸€ä¸ªæ ¸å¿ƒäº‹ä»¶ï¼Œå¹¶éœ€è¦å…±åŒåšå‡ºæˆ˜ç•¥å†³ç­–ã€‚<br>æ‚¨çš„å†³ç­–å°†ç›´æ¥å½±å“å›¢é˜Ÿçš„å…­å¤§æ ¸å¿ƒçŠ¶æ€ï¼Œå¹¶å¯èƒ½è§¦å‘è¿é”ååº”â€”â€”è¿™å°±æ˜¯â€œè´¢å¯Œæµæ²™ç›˜æ•ˆåº”â€ã€‚<br>ä»”ç»†è®¨è®ºï¼Œæ˜æ™ºé€‰æ‹©ï¼ŒåŠªåŠ›å®ç°å›¢é˜Ÿçš„æ„¿æ™¯ï¼`;
            if(choicesContainer) choicesContainer.innerHTML = '';
            if(feedbackText) feedbackText.textContent = "ç‚¹å‡»â€œå¼€å§‹è¿œå¾â€ä»¥è§¦å‘ç¬¬ä¸€ä¸ªäº‹ä»¶ã€‚";
            if(gameOverMessageEl) {
                gameOverMessageEl.textContent = "";
                gameOverMessageEl.style.display = "none";
                gameOverMessageEl.className = ""; 
            }
            if(nextButton) {
                nextButton.disabled = false;
                nextButton.textContent = "å¼€å§‹è¿œå¾";
            }
            if(restartButton) restartButton.style.display = 'none';
            addLogEntry(`æ¸¸æˆåˆå§‹åŒ– - å¹´ä»½: ${gameState.currentYear}, åˆå§‹çŠ¶æ€å·²è®¾å®šã€‚`, "system");
        }

        function updatePhaseDisplay() {
            if (gameState.currentYear === 2025) gameState.phase = "åˆå§‹Â·å¥ åŸºæœŸ (2025)";
            else if (gameState.currentYear >= 2026 && gameState.currentYear <= 2027) gameState.phase = `æˆé•¿Â·æ¢ç´¢æœŸ (${gameState.currentYear})`;
            else if (gameState.currentYear >= 2028 && gameState.currentYear <= 2029) gameState.phase = `æ¨¡å¼Â·çªç ´æœŸ (${gameState.currentYear})`;
            else if (gameState.currentYear >= 2030) gameState.phase = `æœªæ¥Â·æŠ‰æ‹©æœŸ (${gameState.currentYear})`;
            if(phaseDisplay) phaseDisplay.textContent = `é˜¶æ®µï¼š${gameState.phase}`;
        }

        function updateDashboard() {
            if(!currentYearDisplay || !statusDashboard) return; 
            updatePhaseDisplay();
            currentYearDisplay.textContent = `å¹´ä»½ï¼š${gameState.currentYear}`;
            statusUIDefinitions.forEach(def => {
                const valueEl = document.getElementById(`value-${def.id}`);
                const descEl = document.getElementById(`desc-${def.id}`);
                const progressEl = document.getElementById(`progress-${def.id}`);
                
                // Ensure values are clamped and rounded for display
                let displayValue = Math.round(gameState[def.valueKey]);
                if (def.valueKey !== 'productInnovation' && def.valueKey !== 'contributorMorale') { // These are 0-10
                    displayValue = Math.min(100, Math.max(0, displayValue));
                } else {
                    displayValue = Math.min(10, Math.max(0, displayValue));
                }


                if (valueEl) valueEl.textContent = `${displayValue}`;
                if (descEl && gameStateGetters[def.descGetterKey]) {
                     descEl.innerHTML = gameStateGetters[def.descGetterKey](gameState);
                }
                if (progressEl) progressEl.value = displayValue; // Use clamped value for progress bar
            });
            updateProgressColors();
        }
        
        function updateProgressColors() {
            if(!statusDashboard) return;
            statusUIDefinitions.forEach(def => {
                const progressEl = document.getElementById(`progress-${def.id}`);
                if (progressEl && def.colorLogicFn) {
                    const color = def.colorLogicFn(gameState);
                    progressEl.style.setProperty('--default-progress-value-color', color); 
                    
                    // This is a bit of a hack for Webkit as direct JS styling of pseudo-elements is restricted.
                    // We'll inject a style rule if it doesn't exist, or update it.
                    let styleSheet = document.getElementById(`progress-style-${def.id}`);
                    if (!styleSheet) {
                        styleSheet = document.createElement("style");
                        styleSheet.id = `progress-style-${def.id}`;
                        document.head.appendChild(styleSheet);
                    }
                    styleSheet.textContent = `
                        progress#progress-${def.id}::-webkit-progress-value { background-color: ${color}; }
                        progress#progress-${def.id}::-moz-progress-bar { background-color: ${color}; }
                    `;
                    // For modern browsers that support accent-color on progress:
                    progressEl.style.accentColor = color; 
                }
            });
        }

        function loadNextEvent() {
            if (gameState.gameOver) return;
            if (gameState.turn < gameState.maxTurns) {
                gameState.currentEvent = eventLibrary[gameState.turn];
                eventTitle.textContent = gameState.currentEvent.title;
                if (typeof gameState.currentEvent.description === 'function') {
                    eventDescription.textContent = gameState.currentEvent.description(gameState);
                } else {
                    eventDescription.textContent = gameState.currentEvent.description;
                }
                choicesContainer.innerHTML = '';
                gameState.currentEvent.choices.forEach((choice, index) => {
                    const button = document.createElement('button');
                    button.textContent = choice.text;
                    button.onclick = () => handleChoice(index);
                    choicesContainer.appendChild(button);
                });
                feedbackText.textContent = "è¯·åšå‡ºæ‚¨çš„å†³ç­–...";
                nextButton.disabled = true;
                addLogEntry(`äº‹ä»¶è§¦å‘ (${gameState.currentYear}): ${gameState.currentEvent.title}`, "game-event");
            } else {
                // This condition should now primarily be caught by advanceYearAndLoadEvent
                if (!gameState.gameOver) { 
                     triggerGameEnd("VICTORY_TIME_LIMIT");
                }
            }
        }
        
        function clampValues(gs) {
            // Clamp core 0-100 stats
            const coreStats = ["financialHealth", "teamEffectiveness", "productStrength", "marketPosition", "businessViability", "visionExecution", "brandReputation", "communityEngagement"];
            coreStats.forEach(key => {
                gs[key] = Math.round(Math.min(100, Math.max(0, gs[key])));
            });
            // Clamp 0-10 stats
            gs.productInnovation = Math.round(Math.min(10, Math.max(0, gs.productInnovation)));
            gs.contributorMorale = Math.round(Math.min(10, Math.max(0, gs.contributorMorale)));
            // Absolute numbers can also have floors if needed, e.g., communitySize shouldn't be negative
            gs.communitySize = Math.max(0, gs.communitySize);
            gs.contributorsCount = Math.max(0, gs.contributorsCount);
            gs.communityPointsPool = Math.max(0, gs.communityPointsPool);
        }


        function handleChoice(choiceIndex) {
            if (!gameState.currentEvent || gameState.gameOver) return;
            const choice = gameState.currentEvent.choices[choiceIndex];
            const effectSummary = choice.effects(gameState); 
            
            clampValues(gameState); // Ensure all values are within bounds after effects

            gameState.eventHistory.push({ 
                year: gameState.currentYear, turn: gameState.turn, eventId: gameState.currentEvent.id, 
                choiceText: choice.text, effectSummary: effectSummary 
            });
            
            feedbackText.innerHTML = `<b>å†³ç­–åé¦ˆï¼š</b>${choice.feedback}<hr style="margin: 10px 0;"><b>å½±å“æ¦‚è¦ï¼š</b><div style="font-size:0.9em; max-height: 100px; overflow-y:auto; margin-top:5px;">${effectSummary.replace(/ï¼›/g, ';<br>')}</div>`;
            addLogEntry(`å†³ç­–: "${choice.text}". å½±å“: ${effectSummary.split("ã€‚è¿é”ååº”")[0]}...`, "decision");
            choicesContainer.innerHTML = ''; 
            updateDashboard(); 
            if (checkGameOver()) return; 
            if (!gameState.gameOver) {
                nextButton.disabled = false;
                if (gameState.turn < gameState.maxTurns -1 ) { 
                     nextButton.textContent = "è¿›å…¥ä¸‹ä¸€å¹´";
                } else {
                     nextButton.textContent = "æŸ¥çœ‹æœ€ç»ˆç»“æœ";
                }
            }
        }

        function advanceYearAndLoadEvent() {
            if (gameState.gameOver) return;
            
            let oldFH = gameState.financialHealth;
            let yearlyBurnEffect = 5; 
            gameState.financialHealth = Math.max(0, gameState.financialHealth - yearlyBurnEffect);
            clampValues(gameState); // Clamp after passive change
            addLogEntry(`å¹´åº¦ç»“ç®— (${gameState.currentYear}ç»“æŸ)ï¼šåŸºç¡€è¿è¥æˆæœ¬æ¶ˆè€—ï¼Œè´¢åŠ¡çŠ¶å†µ ${oldFH} -> ${gameState.financialHealth}`, "year");

            if (gameState.teamEffectiveness < 80 && gameState.teamEffectiveness > 20 && gameState.financialHealth > 10) {
                let oldTE = gameState.teamEffectiveness;
                gameState.teamEffectiveness = Math.min(100, gameState.teamEffectiveness + 2); 
                clampValues(gameState);
                addLogEntry(`å¹´åº¦ç»“ç®— (${gameState.currentYear}ç»“æŸ)ï¼šå›¢é˜Ÿé€æ­¥ç£¨åˆï¼Œå›¢é˜Ÿæ•ˆèƒ½ ${oldTE} -> ${gameState.teamEffectiveness}`, "system");
            }
            
            const wasFinanciallyStrained = gameState.specialStatus.includes("èµ„é‡‘ç´§å¼ ");
            const isFinanciallyStrained = gameState.financialHealth < 30;

            if (wasFinanciallyStrained && gameState.financialHealth >= 50) { // More robust recovery
                manageSpecialStatus(gameState, ["èµ„é‡‘çŠ¶å†µæ˜¾è‘—æ”¹å–„"], ["èµ„é‡‘ç´§å¼ ", "èµ„é‡‘ç›¸å¯¹å……è£•"]);
                addLogEntry(`çŠ¶æ€æ›´æ–° (${gameState.currentYear}ç»“æŸ)ï¼šè´¢åŠ¡çŠ¶å†µæ˜¾è‘—æ”¹å–„ï¼`, "system");
            } else if (!wasFinanciallyStrained && isFinanciallyStrained) {
                manageSpecialStatus(gameState, ["èµ„é‡‘ç´§å¼ "], ["èµ„é‡‘çŠ¶å†µæ˜¾è‘—æ”¹å–„", "èµ„é‡‘ç›¸å¯¹å……è£•"]);
                 addLogEntry(`çŠ¶æ€æ›´æ–° (${gameState.currentYear}ç»“æŸ)ï¼šè´¢åŠ¡çŠ¶å†µæ¶åŒ–ï¼Œå›¢é˜Ÿé¢ä¸´â€œèµ„é‡‘ç´§å¼ â€ï¼`, "system");
            } else if (gameState.financialHealth >= 50 && !gameState.specialStatus.includes("èµ„é‡‘ç›¸å¯¹å……è£•") && !gameState.specialStatus.includes("èµ„é‡‘çŠ¶å†µæ˜¾è‘—æ”¹å–„")){
                 manageSpecialStatus(gameState, ["èµ„é‡‘ç›¸å¯¹å……è£•"], ["èµ„é‡‘ç´§å¼ "]);
                 addLogEntry(`çŠ¶æ€æ›´æ–° (${gameState.currentYear}ç»“æŸ)ï¼šè´¢åŠ¡çŠ¶å†µä¿æŒç›¸å¯¹å……è£•ã€‚`, "system");
            }
            
            updateDashboard(); 
            if (checkGameOver()) return; 

            gameState.turn++; 
            gameState.currentYear++;
            
            if (gameState.turn >= gameState.maxTurns) { 
                if (!gameState.gameOver) { 
                    triggerGameEnd("VICTORY_TIME_LIMIT");
                }
            } else {
                loadNextEvent();
            }
        }

        function checkGameOver() {
            if (gameState.gameOver) return true; 
            if (gameState.financialHealth <= -20) { 
                triggerGameEnd("FINANCIAL_COLLAPSE");
                return true;
            }
            if (gameState.teamEffectiveness <= 20) { 
                triggerGameEnd("TEAM_COLLAPSE");
                return true;
            }
            return false;
        }

        function triggerGameEnd(reasonCode) {
            gameState.gameOver = true;
            gameState.gameOverReason = reasonCode;
            let message = "";
            let messageClass = ""; 
            switch(reasonCode) {
                case "FINANCIAL_COLLAPSE":
                    message = `æ¸¸æˆç»“æŸï¼šè´¢åŠ¡å±æœºï¼TPGçš„èµ„é‡‘å‚¨å¤‡å·²æ— æ³•æ”¯æ’‘è¿è¥ï¼ˆè´¢åŠ¡çŠ¶å†µè¯„åˆ†: ${Math.round(gameState.financialHealth)}ï¼‰ã€‚è¿œå¾é—æ†¾ä¸­æ­¢...`;
                    messageClass = "crisis";
                    break;
                case "TEAM_COLLAPSE":
                    message = `æ¸¸æˆç»“æŸï¼šå›¢é˜Ÿå±æœºï¼TPGçš„å›¢é˜Ÿæ•ˆèƒ½å·²é™è‡³å†°ç‚¹ï¼ˆå›¢é˜Ÿæ•ˆèƒ½è¯„åˆ†: ${Math.round(gameState.teamEffectiveness)}ï¼‰ï¼Œæ ¸å¿ƒå‡èšåŠ›ä¸§å¤±ã€‚è¿œå¾éš¾ä»¥ä¸ºç»§...`;
                    messageClass = "crisis";
                    break;
                case "VICTORY_TIME_LIMIT":
                    const avgScore = (gameState.financialHealth + gameState.teamEffectiveness + gameState.productStrength + gameState.marketPosition + gameState.businessViability + gameState.visionExecution) / 6;
                    if (gameState.visionExecution >= 70 && avgScore >= 65) { 
                        message = `è¿œå¾åŠŸæˆï¼TPGä¸ä»…æˆåŠŸåº¦è¿‡äº†é£é›¨äº”å¹´ï¼Œæ›´é«˜åº¦å¥‘åˆäº†æœ€åˆçš„æ„¿æ™¯ï¼ˆæ„¿æ™¯æ‰§è¡ŒåŠ›: ${Math.round(gameState.visionExecution)}ï¼Œç»¼åˆè¯„åˆ†: ${Math.round(avgScore)}ï¼‰ã€‚ä¸€ä¸ªå…‰æ˜çš„æœªæ¥åœ¨ç­‰å¾…ï¼`;
                        messageClass = "victory";
                    } else if (gameState.visionExecution >= 45 && avgScore >= 45) { 
                        message = `è¿œå¾æŠµè¾¾ï¼TPGæˆåŠŸå®Œæˆäº†äº”å¹´æ¨¡æ‹Ÿï¼ŒåŸºæœ¬å®ç°äº†æ„¿æ™¯ï¼ˆæ„¿æ™¯æ‰§è¡ŒåŠ›: ${Math.round(gameState.visionExecution)}ï¼Œç»¼åˆè¯„åˆ†: ${Math.round(avgScore)}ï¼‰ã€‚è™½æœ‰æŒ‘æˆ˜ï¼Œä½†æœªæ¥å¯æœŸï¼`;
                        messageClass = "victory";
                    } else if (avgScore >= 30) { // Lowered threshold for "mixed"
                        message = `è¿œå¾å®Œæˆã€‚TPGåšæŒåˆ°äº†æœ€åï¼Œä½†è¿‡ç¨‹å……æ»¡è‰°è¾›ï¼Œéƒ¨åˆ†æ„¿æ™¯æœªèƒ½å®Œå…¨å®ç°ï¼ˆæ„¿æ™¯æ‰§è¡ŒåŠ›: ${Math.round(gameState.visionExecution)}ï¼Œç»¼åˆè¯„åˆ†: ${Math.round(avgScore)}ï¼‰ã€‚æœªæ¥ä»éœ€åŠªåŠ›ã€‚`;
                        messageClass = "defeat"; 
                    } else {
                         message = `è¿œå¾è‰°éš¾ç»“æŸã€‚TPGè™½ç„¶å®Œæˆäº†æ¨¡æ‹Ÿï¼Œä½†å„é¡¹æŒ‡æ ‡å ªå¿§ï¼Œè·ç¦»æœ€åˆçš„æ„¿æ™¯ä¹Ÿæ¸è¡Œæ¸è¿œï¼ˆæ„¿æ™¯æ‰§è¡ŒåŠ›: ${Math.round(gameState.visionExecution)}ï¼Œç»¼åˆè¯„åˆ†: ${Math.round(avgScore)}ï¼‰ã€‚å‰è·¯è¿·èŒ«...`;
                         messageClass = "defeat";
                    }
                    break;
                default:
                    message = "æ¸¸æˆç»“æŸã€‚";
                    messageClass = "defeat";
            }
            gameOverMessageEl.textContent = message;
            gameOverMessageEl.className = ""; 
            gameOverMessageEl.classList.add(messageClass); 
            gameOverMessageEl.style.display = 'block';
            addLogEntry(`æ¸¸æˆç»“å±€ (${reasonCode}): ${message}`, "game-over");
            nextButton.disabled = true;
            choicesContainer.innerHTML = ''; 
            restartButton.style.display = 'inline-block';
            if(eventTitle) eventTitle.textContent = "è¿œå¾ç»“æŸ";
            if(eventDescription) eventDescription.textContent = "è¯·æŸ¥çœ‹ä¸‹æ–¹çš„æœ€ç»ˆç»“å±€ä¿¡æ¯ï¼Œå¹¶ç‚¹å‡»â€œé‡æ–°å¼€å§‹â€è¿›è¡Œæ–°ä¸€è½®çš„æ¨¡æ‹Ÿã€‚";
            if(feedbackText) feedbackText.textContent = "æ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼";
        }

        function addLogEntry(message, type = "system") { 
            const logItem = { message, type, year: gameState.currentYear, turn: gameState.turn, timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' }) };
            gameState.gameLog.push(logItem);
            const li = document.createElement('li');
            li.classList.add('log-entry', type);
            
            let turnPrefix = `å›åˆ ${gameState.turn + 1}`; // Default to 1-indexed turn
            if (type === "system" && message.includes("åˆå§‹åŒ–")) {
                turnPrefix = "åˆå§‹è®¾ç½®";
            } else if (type === "year" && message.includes("ç»“æŸ")) {
                 turnPrefix = `${gameState.currentYear}å¹´ç»ˆ`;
            } else if (type === "game-event" && gameState.turn === 0) { // Event for Turn 0 (Year 2025)
                 turnPrefix = `åˆå§‹äº‹ä»¶`;
            } else if (type === "decision" && gameState.turn === 0) { // Decision for Turn 0
                 turnPrefix = `åˆå§‹å†³ç­–`;
            }


            li.innerHTML = `<strong>[${logItem.year} / ${turnPrefix}]</strong> (${logItem.timestamp}) ${logItem.message}`;
            if (gameLogUl) {
                gameLogUl.appendChild(li);
                gameLogUl.scrollTop = gameLogUl.scrollHeight; 
            }
        }
    </script>
</body>
</html>

